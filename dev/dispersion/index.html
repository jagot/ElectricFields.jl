<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dispersion · ElectricFields.jl</title><meta name="title" content="Dispersion · ElectricFields.jl"/><meta property="og:title" content="Dispersion · ElectricFields.jl"/><meta property="twitter:title" content="Dispersion · ElectricFields.jl"/><meta name="description" content="Documentation for ElectricFields.jl."/><meta property="og:description" content="Documentation for ElectricFields.jl."/><meta property="twitter:description" content="Documentation for ElectricFields.jl."/><meta property="og:url" content="https://www.tipota.org/ElectricFields.jl/dispersion/"/><meta property="twitter:url" content="https://www.tipota.org/ElectricFields.jl/dispersion/"/><link rel="canonical" href="https://www.tipota.org/ElectricFields.jl/dispersion/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ElectricFields.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../interface/">Interface</a></li><li><a class="tocitem" href="../field_types/">Field types</a></li><li><a class="tocitem" href="../envelopes/">Envelopes</a></li><li><a class="tocitem" href="../carriers/">Carriers</a></li><li><a class="tocitem" href="../properties/">Field properties</a></li><li class="is-active"><a class="tocitem" href>Dispersion</a><ul class="internal"><li><a class="tocitem" href="#Simple-dispersive-elements"><span>Simple dispersive elements</span></a></li><li><a class="tocitem" href="#Dispersive-media"><span>Dispersive media</span></a></li><li><a class="tocitem" href="#B-splines"><span>B-splines</span></a></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Dispersion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Dispersion</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jagot/ElectricFields.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jagot/ElectricFields.jl/blob/master/docs/src/dispersion.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Dispersion"><a class="docs-heading-anchor" href="#Dispersion">Dispersion</a><a id="Dispersion-1"></a><a class="docs-heading-anchor-permalink" href="#Dispersion" title="Permalink"></a></h1><p>Dispersion is most easily calculated in the frequency domain, where it simply amounts to multiplication of the spectral amplitudes by a transfer function:</p><p class="math-container">\[\hat{\vec{F}}_2(\omega) =
H(\omega)
\hat{\vec{F}}_1(\omega)\]</p><p>where <span>$H(\omega)$</span> is the transfer function, <span>$\hat{\vec{F}}_1(\omega)$</span> is the field before dispersion, and <span>$\hat{\vec{F}}_2(\omega)$</span> after. Since <span>$\hat{\vec{F}}(\omega)\equiv-\im\omega\hat{\vec{A}}(\omega)$</span>, the same relation holds for the vector potential:</p><p class="math-container">\[\hat{\vec{A}}_2(\omega) =
H(\omega)
\hat{\vec{A}}_1(\omega).\]</p><p>Dispersion is implemented in ElectricFields.jl via the transform pair <a href="../interface/#AbstractFFTs.rfft"><code>rfft</code></a>/<a href="../interface/#AbstractFFTs.irfft"><code>irfft</code></a>:</p><p class="math-container">\[\vec{A}_1\{t\}
\overset{\texttt{rfft}}{\to}
\hat{\vec{A}}_1\{\omega\}
\to
\hat{\vec{A}}_2\{\omega\} =
H\{\omega\}
\hat{\vec{A}}_1\{\omega\}
\overset{\texttt{irfft}}{\to}
\vec{A}_2\{t\}\]</p><p>where the notation <span>$\{t\}$</span> and <span>$\{\omega\}$</span> signifies uniformly spaced vectors, since the FFT is a numeric algorithm. Since <a href="../interface/#ElectricFields.field_amplitude"><code>field_amplitude</code></a> and <a href="../interface/#ElectricFields.vector_potential"><code>vector_potential</code></a> allow the evaluation of a field at arbitrary time points (and integrals over arbitrary time intervals), we fit <span>$\vec{A}_2\{t\}$</span> to a <a href="#ElectricFields.BSplineField"><code>BSplineField</code></a>. The next complication is that the transfer function <span>$H$</span> will in general introduce a temporal spread, such that the compact support of the dispersed field is much wider than that of the original one. We therefore successively increase the time span (using <a href="#ElectricFields.find_time_span"><code>ElectricFields.find_time_span</code></a>) we evaluate <span>$\vec{A}_2\{t\}$</span> on until it has converged. Before we fit this function to a <a href="#ElectricFields.BSplineField"><code>BSplineField</code></a>, we truncate the time span again to a window where <span>$|\vec{A}_2\{t\}|&gt;\epsilon$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.DispersedField" href="#ElectricFields.DispersedField"><code>ElectricFields.DispersedField</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DispersedField(f, de, B, s)</code></pre><p>Represents the field <code>f</code> dispersed through the <a href="#ElectricFields.DispersiveElement"><code>DispersiveElement</code></a> <code>de</code>. Since the dispersion is most efficiently calculated in the frequency domain, this is done via <a href="../interface/#AbstractFFTs.rfft"><code>rfft</code></a>/<a href="../interface/#AbstractFFTs.irfft"><code>irfft</code></a>, and the dispersed field is interpolated as the <a href="#ElectricFields.BSplineField"><code>BSplineField</code></a> <code>B</code>. The temporal <a href="../interface/#ElectricFields.span"><code>span</code></a> of the dispersed field is given by <code>s</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersed_fields.jl#L1-L10">source</a></section></article><h2 id="Simple-dispersive-elements"><a class="docs-heading-anchor" href="#Simple-dispersive-elements">Simple dispersive elements</a><a id="Simple-dispersive-elements-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-dispersive-elements" title="Permalink"></a></h2><p>Any purely dispersive medium (i.e. no loss or gain) can be written as</p><p class="math-container">\[H(\omega) = \exp[-\im\phi(\omega)]\]</p><p>where the phase can be Taylor-expanded as</p><p class="math-container">\[\phi(\omega) =
\phi_0 +
a(\omega-\omega_0) +
b(\omega-\omega_0)^2 +
...,\]</p><p><span>$\phi_0$</span> is a <a href="#ElectricFields.PhaseShift"><code>PhaseShift</code></a>, <span>$a=2\pi t_d$</span> amounts to a time <a href="../field_types/#ElectricFields.delay"><code>delay</code></a> by <span>$t_d$</span> (by the Fourier shift theorem), and <span>$b$</span> introduced a <a href="#ElectricFields.Chirp"><code>Chirp</code></a>.</p><pre><code class="language-julia-repl hljs">julia&gt; @field(F) do
           λ = 800u&quot;nm&quot;
           I₀ = 1.0
           τ = 3u&quot;fs&quot;
           σoff = 4.0
           σmax = 6.0
           env = :trunc_gauss
           ϕ = π
       end
Linearly polarized field with
  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =&gt;
    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹
    - A₀ = 17.5580 au
  – a Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz); CEP = 1.00π
  – and a Truncated Gaussian envelope of duration 124.0241 jiffies = 3.0000 fs (intensity FWHM; turn-off from 5.0959 fs to 7.6439 fs)
  – and a bandwidth of 0.0224 Ha = 608.3170 meV ⟺ 147.0904 THz ⟺ 5933.9307 Bohr = 314.0101 nm
  – Uₚ = 77.0706 Ha = 2.0972 keV =&gt; α = 308.2823 Bohr = 16.3136 nm

julia&gt; Fc = chirp(F, austrip(5u&quot;fs^2&quot;), verbosity=4)
┌ Info: Finding large enough time span to encompass dispersed field
│   f =
│    Linearly polarized field with
│      - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =&gt;
│        - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹
│        - A₀ = 17.5580 au
│      – a Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz); CEP = 1.00π
│      – and a Truncated Gaussian envelope of duration 124.0241 jiffies = 3.0000 fs (intensity FWHM; turn-off from 5.0959 fs to 7.6439 fs)
│      – and a bandwidth of 0.0224 Ha = 608.3170 meV ⟺ 147.0904 THz ⟺ 5933.9307 Bohr = 314.0101 nm
│      – Uₚ = 77.0706 Ha = 2.0972 keV =&gt; α = 308.2823 Bohr = 16.3136 nm
│   de = Chirp(b = 8545.5457 = 5.0000 fs², ω₀ = 0.0570 = 1.5498 eV)
│   max_iter = 7
│   ξ = 2.0
└   tol = 0.0005
----------------------------------------------------------------------------------------------------
1
t′ = -632.0183332958276:1.1049271561115868:633.1232604519392
R = 2.095947834009663
----------------------------------------------------------------------------------------------------
2
t′ = -1264.0366665916551:1.1049271561115868:1265.1415937477668
R = 0.16138039790711892
----------------------------------------------------------------------------------------------------
3
t′ = -2528.0733331833103:1.1049271561115868:2529.178260339422
R = 0.0013929399886955529
----------------------------------------------------------------------------------------------------
4
t′ = -5056.146666366621:1.1049271561115868:5057.251593522733
R = 0.00012089884366390845
┌ Info: Truncated to time interval -896.38155595379 .. 888.6605640985183
│   a = 1480
│   b = 3098
│   cutoff = 0.0014901161193847656
└   abs_cutoff = 0.014115901307391281
┌ Info: Generated B-spline
│   num_knots = 324
└   B = BSpline basis with typename(ElectricFields.LinearKnotSet)(Float64) of order k = 3 (parabolic) on -896.38155595379 .. 888.6605640985183 (324 intervals)
DispersedField:
Linearly polarized field with
  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =&gt;
    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹
    - A₀ = 17.5580 au
  – a Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz); CEP = 1.00π
  – and a Truncated Gaussian envelope of duration 124.0241 jiffies = 3.0000 fs (intensity FWHM; turn-off from 5.0959 fs to 7.6439 fs)
  – and a bandwidth of 0.0224 Ha = 608.3170 meV ⟺ 147.0904 THz ⟺ 5933.9307 Bohr = 314.0101 nm
  – Uₚ = 77.0706 Ha = 2.0972 keV =&gt; α = 308.2823 Bohr = 16.3136 nm
  – dispersed through Chirp(b = 8545.5457 = 5.0000 fs², ω₀ = 0.0570 = 1.5498 eV)</code></pre><p><img src="../figures/chirped_field.svg" alt="Chirped field"/></p><p>In black, we see the original field, in red the chirped field, and the bottom panel shows a <a href="https://en.wikipedia.org/wiki/Gabor_transform">Gabor transform</a> of the chirped field, along with horizontal line at the carrier frequency <span>$\omega_0$</span>, and a diagonal line at the expected instantaneous frequency <span>$\omega=\omega_0 + \frac{1}{2}\frac{b}{\gamma^2 + b^2}t$</span>, where <span>$\gamma = \frac{\tau^2}{8\ln2}$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.DispersiveElement" href="#ElectricFields.DispersiveElement"><code>ElectricFields.DispersiveElement</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DispersiveElement</code></pre><p>Base type for all dispersive elements</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_elements.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.PhaseShift" href="#ElectricFields.PhaseShift"><code>ElectricFields.PhaseShift</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PhaseShift(ϕ)</code></pre><p>Represents a phase shift according to</p><p class="math-container">\[H(\omega) =
\exp(-\im\phi).\]</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; PhaseShift(6)
PhaseShift(ϕ = 6.0000 rad)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_elements.jl#L38-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.phase_shift-Tuple{ElectricFields.AbstractField, Any}" href="#ElectricFields.phase_shift-Tuple{ElectricFields.AbstractField, Any}"><code>ElectricFields.phase_shift</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">phase_shift(f, ϕ)</code></pre><p>Returns the field resulting from applying a <a href="#ElectricFields.PhaseShift"><code>PhaseShift</code></a> to the field <code>f</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_elements.jl#L66-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.Chirp" href="#ElectricFields.Chirp"><code>ElectricFields.Chirp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Chirp(b, ω₀)</code></pre><p>Represents chirp according to</p><p class="math-container">\[H(\omega) =
\exp[-\im b(ω-ω_0)^2].\]</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; Chirp(austrip(5u&quot;fs^2&quot;), austrip(1.5u&quot;eV&quot;))
Chirp(b = 8545.5457 = 5.0000 fs², ω₀ = 0.0551 = 1.5000 eV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_elements.jl#L77-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.chirp" href="#ElectricFields.chirp"><code>ElectricFields.chirp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">chirp(f, b, ω₀=photon_energy(f))</code></pre><p>Returns the field resulting from applying a <a href="#ElectricFields.Chirp"><code>Chirp</code></a> to the field <code>f</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; @field(F) do
           I₀ = 1.0
           T = 2.0u&quot;fs&quot;
           σ = 3.0
           Tmax = 3.0
       end
Linearly polarized field with
  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =&gt;
    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹
    - A₀ = 13.1594 au
  – a Fixed carrier @ λ = 599.5849 nm (T = 2.0000 fs, ω = 0.0760 Ha = 2.0678 eV, f = 500.0000 THz)
  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±82.68σ)
  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 58518.2144 Bohr = 3.0967 μm
  – Uₚ = 43.2922 Ha = 1.1780 keV =&gt; α = 173.1690 Bohr = 9.1637 nm

julia&gt; chirp(F, austrip(1u&quot;fs^2&quot;))
DispersedField:
Linearly polarized field with
  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =&gt;
    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹
    - A₀ = 13.1594 au
  – a Fixed carrier @ λ = 599.5849 nm (T = 2.0000 fs, ω = 0.0760 Ha = 2.0678 eV, f = 500.0000 THz)
  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±82.68σ)
  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 58518.2144 Bohr = 3.0967 μm
  – Uₚ = 43.2922 Ha = 1.1780 keV =&gt; α = 173.1690 Bohr = 9.1637 nm
  – dispersed through Chirp(b = 1709.1091 = 1.0000 fs², ω₀ = 0.0760 = 2.0678 eV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_elements.jl#L111-L147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.CascadedDispersiveElement" href="#ElectricFields.CascadedDispersiveElement"><code>ElectricFields.CascadedDispersiveElement</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CascadedDispersiveElement(elements)</code></pre><p>Represents the combination of multiple <a href="#ElectricFields.DispersiveElement"><code>DispersiveElement</code></a>s.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; PhaseShift(6)*Chirp(austrip(5u&quot;fs^2&quot;), austrip(1.5u&quot;eV&quot;))
[PhaseShift(ϕ = 6.0000 rad) ∗ Chirp(b = 8545.5457 = 5.0000 fs², ω₀ = 0.0551 = 1.5000 eV)]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_elements.jl#L153-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.find_time_span" href="#ElectricFields.find_time_span"><code>ElectricFields.find_time_span</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_time_span(f, de[, fs]; max_iter=10, ξ=2.0, tol)</code></pre><p>Find a suitable time span <span>$[a,b]$</span> such that when <code>f</code> is dispersed through the <a href="#ElectricFields.DispersiveElement"><code>DispersiveElement</code></a> <code>de</code>, the compact support of the resulting field is contained in the time interval. This is done by successively multiplying the time span on which <code>F</code> is evaluated <code>ξ</code> before the <code>RFFT</code>, until the <code>IRFFT</code> has converged.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_elements.jl#L239-L247">source</a></section></article><h2 id="Dispersive-media"><a class="docs-heading-anchor" href="#Dispersive-media">Dispersive media</a><a id="Dispersive-media-1"></a><a class="docs-heading-anchor-permalink" href="#Dispersive-media" title="Permalink"></a></h2><p>In addition to the simple, analytic dispersive elements listed above, <a href="#ElectricFields.PhaseShift"><code>PhaseShift</code></a> and <a href="#ElectricFields.Chirp"><code>Chirp</code></a>, we also support calculating the dispersion resulting from pulse propagation through a dispersive <a href="#ElectricFields.Medium"><code>ElectricFields.Medium</code></a>, which models a physical medium phenomenologically. Typically, one employs a <a href="#ElectricFields.Sellmeier"><code>Sellmeier</code></a> equation to describe the variation of the refractive index with the wavelength of the incident light, and the compute the dispersion according to</p><p class="math-container">\[H(\omega) =
\exp[-\im k(\omega)d],\]</p><p>where <span>$d$</span> is the thickness of the medium,</p><p class="math-container">\[k(\omega) = n(\omega)k_0\]</p><p>is the wavevector in the medium with refractive index <span>$n(\omega)$</span>. For convenience, we typically subtract the linear component at the carrier energy <span>$\omega_0$</span> according to</p><p class="math-container">\[\tilde{k}(\omega) =
k(\omega) -
\omega
\left.\frac{\partial k}{\partial\omega}\right|_{\omega_0}\]</p><p>to keep the pulse centred in the frame of reference.</p><p>For an <a href="#ElectricFields.IsotropicMedium"><code>IsotropicMedium</code></a>, the square of the refractive index, <span>$n^2(\lambda)$</span> does not depend on the direction of polarization. For an anistropic medium, a <a href="#ElectricFields.Crystal"><code>Crystal</code></a>, different polarization axes may have different refractive indices. This is modelled using the <a href="https://en.wikipedia.org/wiki/Index_ellipsoid">index ellipsoid</a><sup class="footnote-reference"><a id="citeref-demo" href="#footnote-demo">[demo]</a></sup>, which obeys</p><p class="math-container">\[\frac{x^2}{n_a^2} + \frac{y^2}{n_b^2} + \frac{z^2}{n_c^2} = 1.\]</p><p>By choosing the orientation of the crystal appropriately (or equivalently rotate the field), we can achieve different dispersion for the different components of the field:</p><pre><code class="language-julia-repl hljs">julia&gt; @field(F) do
           λ = 800u&quot;nm&quot;
           I₀ = 1.0
           τ = 3u&quot;fs&quot;
           σoff = 4.0
           σmax = 6.0
           env = :trunc_gauss
           ϕ = π
       end;

julia&gt; F = rotate(F, ElectricFields.compute_rotation((π/3, [0.4,1,0])));

julia&gt; de = Crystal(KTP, 12u&quot;μm&quot;, ω₀=photon_energy(F));

julia&gt; Fc = DispersedField(F, de)
DispersedField:
Transversely polarized field with
  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =&gt;
    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹
    - A₀ = 17.5580 au
  – a LinearTransverseCarrier: Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz); CEP = 1.00π
  – a Truncated Gaussian envelope of duration 124.0241 jiffies = 3.0000 fs (intensity FWHM; turn-off from 5.0959 fs to 7.6439 fs)
  – and a rotation of 0.33π about [0.371, 0.928, 0.000]
  – and a bandwidth of 0.0224 Ha = 608.3170 meV ⟺ 147.0904 THz ⟺ 5933.9307 Bohr = 314.0101 nm
  – Uₚ = 77.0706 Ha = 2.0972 keV =&gt; α = 308.2823 Bohr = 16.3136 nm
  – dispersed through Crystal(226767.13 Bohr = 12.00 μm of Sellmeier{Float64, Float64, Quantity{Float64, 𝐋², Unitful.FreeUnits{(μm²,), 𝐋², nothing}}, Tuple{Quantity{Float64, 𝐋⁻², Unitful.FreeUnits{(μm⁻²,), 𝐋⁻², nothing}}}}[Sellmeier(1.10468, [0.89342], [2], [0.04438 μm²], [-0.01036 μm⁻²], [2]), Sellmeier(1.14559, [0.87629], [2], [0.0485 μm²], [-0.01173 μm⁻²], [2]), Sellmeier(0.9446, [1.3617], [2], [0.047 μm²], [-0.01491 μm⁻²], [2])], R = [1.0 0.0 0.0; 0.0 1.0 0.0; 0.0 0.0 1.0], ∂k∂ω₀ = 0.0134)</code></pre><p><img src="../figures/dispersed_field.svg" alt="Dispersed field"/></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.Medium" href="#ElectricFields.Medium"><code>ElectricFields.Medium</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Medium</code></pre><p>Base type for all dispersive media</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_media.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.IsotropicMedium" href="#ElectricFields.IsotropicMedium"><code>ElectricFields.IsotropicMedium</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">IsotropicMedium(material, d[, ∂k∂ω₀ = 0])</code></pre><p>Describes the dispersion through an isotropic medium of thickness <code>d</code> (such as an atomic gas), where the refractive index, given by <code>material</code>, is the same in all directions.</p><p>The optional <code>∂k∂ω₀</code> can be used to subtract the linear slope from the dispersion relation, i.e. remove the time shift, such that a pulse with central angular frequency <code>ω₀</code> stays centred in the frame of reference.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_media.jl#L8-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.IsotropicMedium-Tuple{Any, Any}" href="#ElectricFields.IsotropicMedium-Tuple{Any, Any}"><code>ElectricFields.IsotropicMedium</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">IsotropicMedium(material, d; ω₀)</code></pre><p>Convenience constructor for <a href="#ElectricFields.IsotropicMedium"><code>IsotropicMedium</code></a>; if a central angular frequency <code>ω₀</code> is provided, the linear slope of the dispersion of the <code>material</code> is computed at <code>ω₀</code>. This slope is subsequently subtracted from the dispersion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_media.jl#L26-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.Crystal" href="#ElectricFields.Crystal"><code>ElectricFields.Crystal</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Crystal(material, d, R[, ∂k∂ω₀ = 0])</code></pre><p>Describes the dispersion through a general crystal of thickness <code>d</code> and orientation given by the rotation <code>R</code>, with different refractive indices, given by the components of <code>material</code>, along the different crystal axes.</p><p>In the special case where <code>material</code> has two components, we have a <em>uniaxial</em> crystal, which is birefringent, and <code>material[1]</code> is referred to as <em>ordinary</em> the refractive index, and <code>material[2]</code> as the <em>extraordinary</em> refractive index.</p><p>The optional <code>∂k∂ω₀</code> can be used to subtract the linear slope from the dispersion relation, i.e. remove the time shift, such that a pulse with central angular frequency <code>ω₀</code> stays centred in the frame of reference.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_media.jl#L63-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.Crystal" href="#ElectricFields.Crystal"><code>ElectricFields.Crystal</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Crystal(material, d, R=I; ω₀)</code></pre><p>Convenience constructor for <a href="#ElectricFields.Crystal"><code>Crystal</code></a>; if a central angular frequency <code>ω₀</code> is provided, the linear slope of the dispersion of the <code>material</code> is computed at <code>ω₀</code>. This slope is subsequently subtracted from the dispersion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/dispersive_media.jl#L88-L95">source</a></section></article><h3 id="Sellmeier-equations"><a class="docs-heading-anchor" href="#Sellmeier-equations">Sellmeier equations</a><a id="Sellmeier-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Sellmeier-equations" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.Sellmeier" href="#ElectricFields.Sellmeier"><code>ElectricFields.Sellmeier</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Sellmeier(A, B, p, C, D, q)</code></pre><p>The <a href="https://en.wikipedia.org/wiki/Sellmeier_equation">Sellmeier equations</a> are used to describe dispersion in glass using a series of resonances, here generalized to support variations found in the literature:</p><p class="math-container">\[n^2(\lambda) =
1 + A + \sum_i \frac {B_i\lambda^{p_i}}{\lambda^2-C_i} + \sum_j D_j \lambda^{q_j}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/sellmeier.jl#L8-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.BK7" href="#ElectricFields.BK7"><code>ElectricFields.BK7</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">BK7</code></pre><p><a href="https://en.wikipedia.org/wiki/Borosilicate_glass">Borosilicate glass</a> is commonly used in optical lenses</p><p class="math-container">\[n^2(\lambda) =
1 +
\frac{1.03961212\lambda^2}{\lambda^2 - 6.00069867\times10^{-3}\;\textrm{μm}^2} +
\frac{0.231792344\lambda^2}{\lambda^2 - 2.00179144\times10^{-2}\;\textrm{μm}^2} +
\frac{1.01046945}{\lambda^2 - 1.03560653\times10^{2}\;\textrm{μm}^2}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/sellmeier.jl#L65-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.SiO₂" href="#ElectricFields.SiO₂"><code>ElectricFields.SiO₂</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">SiO₂</code></pre><p><a href="https://en.wikipedia.org/wiki/Fused_quartz#Optical_properties">Fused silica</a></p><p class="math-container">\[n^2(\lambda) =
1 +
\frac{0.6961663\lambda^2}{\lambda^2-(0.0684043\;\textrm{μm})^2} +
\frac{0.4079426\lambda^2}{\lambda^2-(0.1162414\;\textrm{μm})^2} +
\frac{0.8974794\lambda^2}{\lambda^2-(9.896161\;\textrm{μm})^2}.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/sellmeier.jl#L84-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.Calcite" href="#ElectricFields.Calcite"><code>ElectricFields.Calcite</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Calcite</code></pre><p>Calcite is a uniaxial, birefringent crystal.</p><p>Numbers taken from <a href="http://www.newlightphotonics.com/v1/calcite-properties.html">http://www.newlightphotonics.com/v1/calcite-properties.html</a>.</p><p class="math-container">\[\begin{aligned}
n_{\mathrm{o}}^2(\lambda)
&amp;=
2.69705 +
\frac{0.0192064}{\lambda^2-0.01820\;\textrm{μm}^2} -
0.0151624\lambda^2, \\
n_{\mathrm{e}}^2(\lambda)
&amp;=
2.18438 +
\frac{0.0087309}{\lambda^2-0.01018\;\textrm{μm}^2} -
0.0024411\lambda^2.
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/sellmeier.jl#L102-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.Quartz" href="#ElectricFields.Quartz"><code>ElectricFields.Quartz</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Quartz</code></pre><p>Quartz is a uniaxial, birefrigent crystal.</p><p>Numbers taken from <a href="https://www.newlightphotonics.com/v1/quartz-properties.html">https://www.newlightphotonics.com/v1/quartz-properties.html</a>.</p><p class="math-container">\[\begin{aligned}
n_{\mathrm{o}}^2(\lambda)
&amp;=2.3573 -
0.01170\;\textrm{μm}^{-2}\lambda^2 +
\frac{0.01054\;\textrm{μm}^{2}}{\lambda^2} +
\frac{1.3414\times10^{-4}\;\textrm{μm}^{4}}{\lambda^4} -
\frac{4.4537\times10^{-7}\;\textrm{μm}^{6}}{\lambda^6} +
\frac{5.9236\times10^{-8}\;\textrm{μm}^{8}}{\lambda^8}, \\
n_{\mathrm{e}}^2(\lambda)
&amp;=2.3849 -
0.01259\;\textrm{μm}^{-2}\lambda^2 +
\frac{0.01079\;\textrm{μm}^{2}}{\lambda^2} +
\frac{1.6518\times10^{-4}\;\textrm{μm}^{4}}{\lambda^4} -
\frac{1.9474\times10^{-6}\;\textrm{μm}^{6}}{\lambda^6} +
\frac{9.3648\times10^{-8}\;\textrm{μm}^{8}}{\lambda^8}.
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/sellmeier.jl#L129-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.KTP" href="#ElectricFields.KTP"><code>ElectricFields.KTP</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">KTP</code></pre><p>KTP is a biaxial crystal.</p><p>Numbers taken from <a href="https://www.redoptronics.com/KTP-crystal.html">https://www.redoptronics.com/KTP-crystal.html</a>.</p><p class="math-container">\[\begin{aligned}
n_x^2(\lambda)
&amp;= 2.10468 +
\frac{0.89342\lambda^2}{\lambda^2-0.04438\;\textrm{μm}^2} -
0.01036\;\textrm{μm}^{-2}\lambda^2, \\
n_y^2(\lambda)
&amp;= 2.14559 +
\frac{0.87629\lambda^2}{\lambda^2-0.0485\;\textrm{μm}^2} -
0.01173\;\textrm{μm}^{-2}\lambda^2, \\
n_z^2(\lambda)
&amp;= 1.9446 +
\frac{1.3617\lambda^2}{\lambda^2-0.047\;\textrm{μm}^2} -
0.01491\;\textrm{μm}^{-2}\lambda^2. \\
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/sellmeier.jl#L173-L196">source</a></section></article><h2 id="B-splines"><a class="docs-heading-anchor" href="#B-splines">B-splines</a><a id="B-splines-1"></a><a class="docs-heading-anchor-permalink" href="#B-splines" title="Permalink"></a></h2><p>The present B-spline implementation is cannibalized from <a href="https://github.com/JuliaApproximation/CompactBases.jl">CompactBases.jl</a>, to avoid dragging in all the dependencies.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.BSplineField" href="#ElectricFields.BSplineField"><code>ElectricFields.BSplineField</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BSplineField(B, C)</code></pre><p>Represents an electric field using an expansion over a B-spline basis <code>B</code>, with <code>C</code> being the array (vector for 1d fields, 3-column matrix for 3d fields) expansion coefficients for the vector potential.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/bspline_field.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectricFields.BSpline" href="#ElectricFields.BSpline"><code>ElectricFields.BSpline</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BSpline(t, x, w, B, S)</code></pre><p>Basis structure for the B-splines generated by the knot set <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagot/ElectricFields.jl/blob/ad948f22bd1b6ae1d315ac8bd5f2b908db6f612c/src/bsplines.jl#L22-L26">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-demo"><a class="tag is-link" href="#citeref-demo">demo</a><a href="https://micro.magnet.fsu.edu/primer/java/polarizedlight/ellipsoid/index.html">Interactive demonstration of the index ellipsoid.</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../properties/">« Field properties</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 14 May 2024 13:31">Tuesday 14 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
