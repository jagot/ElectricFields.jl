var documenterSearchIndex = {"docs":
[{"location":"field_types/#Field-types","page":"Field types","title":"Field types","text":"","category":"section"},{"location":"field_types/#Basic-field-types","page":"Field types","title":"Basic field types","text":"","category":"section"},{"location":"field_types/","page":"Field types","title":"Field types","text":"ElectricFields.LinearField\nElectricFields.TransverseField\nElectricFields.LinearTransverseField\nElectricFields.ConstantField\nElectricFields.Ramp","category":"page"},{"location":"field_types/#ElectricFields.LinearField","page":"Field types","title":"ElectricFields.LinearField","text":"LinearField\n\nLinearly polarized field, i.e. the field amplitude is scalar. Consisting of a peak vector potential, a vector envelope, and a carrier, which has to be a LinearCarrier.\n\nExamples\n\njulia> @field(A) do\n       I₀ = 1e14u\"W/cm^2\"\n       λ = 800.0u\"nm\"\n       τ = 6.2u\"fs\"\n       tmax = 20.0u\"fs\"\n       end\nLinearly polarized field with\n  - I₀ = 2.8495e-03 au = 1.0e14 W cm^-2 =>\n    - E₀ = 5.3380e-02 au = 27.4492 GV m^-1\n    - A₀ = 0.9372 au\n  – a Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz)\n  – and a Gaussian envelope of duration 6.2000 fs (intensity FWHM; ±8.11σ)\n  – and a bandwidth of 0.0108 Ha = 294.3469 meV ⟺ 71.1728 THz ⟺ 2871.2568 Bohr = 151.9404 nm\n  – Uₚ = 0.2196 Ha = 5.9759 eV => α = 16.4562 Bohr = 870.8242 pm\n\njulia> @field(B) do\n       I₀ = 0.05\n       ω = 1.0\n       ramp = 1.0\n       flat = 3.0\n       env = :trapezoidal\n       end\nLinearly polarized field with\n  - I₀ = 5.0000e-02 au = 1.7547226e15 W cm^-2 =>\n    - E₀ = 2.2361e-01 au = 114.9832 GV m^-1\n    - A₀ = 0.2236 au\n  – a Fixed carrier @ λ = 45.5634 nm (T = 151.9830 as, ω = 1.0000 Ha = 27.2114 eV, f = 6.5797 PHz)\n  – and a /1‾3‾1\\ cycles trapezoidal envelope, with linear ramps\n  – and a bandwidth of Inf Ha = Inf eV ⟺ Inf Hz ⟺ Inf Bohr = Inf m\n  – Uₚ = 0.0125 Ha = 340.1423 meV => α = 0.2236 Bohr = 11.8328 pm\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.TransverseField","page":"Field types","title":"ElectricFields.TransverseField","text":"TransverseField\n\nTransversely polarized field, i.e the polarization vector is confined to the plane that is perpendicular to the direction of propagation. If the propagation vector is not rotated, this plane is the z-x, with z by convention being the principal polarization axis, and y is the direction of propagation.\n\nThe formal definition is\n\nvecA(t)defd A_0 f(t) ImvecJexpim(omega t + phi)\n\nusing the complex-valued Jones vector vecJ, but in practice, we use a rotation matrix matR and the Carriers give the amplitudes in the canonical, unrotated coordinate sytem:\n\nvecA(t) = A_0 f(t) matRvecC(t)\n\nExamples\n\njulia> # Circularly polarized field\n\njulia> @field(A) do\n       I₀ = 1e14u\"W/cm^2\"\n       λ = 800.0u\"nm\"\n       τ = 6.2u\"fs\"\n       tmax = 20.0u\"fs\"\n       ξ = 1.0\n       end\nTransversely polarized field with\n  - I₀ = 2.8495e-03 au = 1.0e14 W cm^-2 =>\n    - E₀ = 5.3380e-02 au = 27.4492 GV m^-1\n    - A₀ = 0.9372 au\n  – a Elliptical carrier with ξ = 1.00 (RCP) @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz)\n  – and a Gaussian envelope of duration 6.2000 fs (intensity FWHM; ±8.11σ)\n  – and a bandwidth of 0.0108 Ha = 294.3469 meV ⟺ 71.1728 THz ⟺ 2871.2568 Bohr = 151.9404 nm\n  – Uₚ = 0.2196 Ha = 5.9759 eV => α = 16.4562 Bohr = 870.8242 pm\n\njulia> # Linearly polarized field, but explicitly in 3D\n\njulia> @field(B) do\n       I₀ = 1e14u\"W/cm^2\"\n       λ = 800.0u\"nm\"\n       τ = 6.2u\"fs\"\n       tmax = 20.0u\"fs\"\n       kind = :transverse\n       end\nTransversely polarized field with\n  - I₀ = 2.8495e-03 au = 1.0e14 W cm^-2 =>\n    - E₀ = 5.3380e-02 au = 27.4492 GV m^-1\n    - A₀ = 0.9372 au\n  – a LinearTransverseCarrier: Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz)\n  – and a Gaussian envelope of duration 6.2000 fs (intensity FWHM; ±8.11σ)\n  – and a bandwidth of 0.0108 Ha = 294.3469 meV ⟺ 71.1728 THz ⟺ 2871.2568 Bohr = 151.9404 nm\n  – Uₚ = 0.2196 Ha = 5.9759 eV => α = 16.4562 Bohr = 870.8242 pm\n\njulia> # Linearly polarized field, rotated\n\njulia> @field(C) do\n       I₀ = 1e14u\"W/cm^2\"\n       λ = 800.0u\"nm\"\n       τ = 6.2u\"fs\"\n       tmax = 20.0u\"fs\"\n       rotation = π/3, [0,0,1]\n       end\nTransversely polarized field with\n  - I₀ = 2.8495e-03 au = 1.0e14 W cm^-2 =>\n    - E₀ = 5.3380e-02 au = 27.4492 GV m^-1\n    - A₀ = 0.9372 au\n  – a LinearTransverseCarrier: Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz)\n  – a Gaussian envelope of duration 6.2000 fs (intensity FWHM; ±8.11σ)\n  – and a rotation of 0.33π about [0.000, 0.000, 1.000]\n  – and a bandwidth of 0.0108 Ha = 294.3469 meV ⟺ 71.1728 THz ⟺ 2871.2568 Bohr = 151.9404 nm\n  – Uₚ = 0.2196 Ha = 5.9759 eV => α = 16.4562 Bohr = 870.8242 pm\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.LinearTransverseField","page":"Field types","title":"ElectricFields.LinearTransverseField","text":"LinearTransverseField\n\nLinearly polarized field, but explicitly in 3d, i.e the polarization vector is confined to a line in the plane that is perpendicular to the direction of propagation. If the propagation vector is not rotated, this plane is the z-x, with z by convention being the principal polarization axis, and y is the direction of propagation.\n\nThis is mostly used as a proxy, if one wants to calculate using a manifestly linearly polarized field in 3d. See also LinearTransverseCarrier.\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.ConstantField","page":"Field types","title":"ElectricFields.ConstantField","text":"ConstantField(tmax, E₀)\n\nThe field amplitude of a constant field is defined as\n\nF(t) = begincases\nE_0  0 leq t leq t_textrmmax \n0  textrmelse\nendcases\nimplies\nA(t) = begincases\n-E_0t  0 leq t leq t_textrmmax \nA(t_textrmmax)  t_textrmmax  t \n0  textrmelse\nendcases\n\nSince the vector potential is non-zero at the end of the pulse, this is a non-propagating field, i.e. it does not correspond to a freely propagating pulse. It however corresponds to the field in an idealized capacitor, i.e. two plates of opposite charge.\n\nExample\n\njulia> @field(F) do\n       I₀ = 1e13u\"W/cm^2\"\n       tmax = 3.0u\"fs\"\n       kind = :constant\n       end\nConstant field of\n  - 124.0241 jiffies = 3.0000 fs duration, and\n  - E₀ = 1.6880e-02 au = 8.6802 GV m^-1\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.Ramp","page":"Field types","title":"ElectricFields.Ramp","text":"Ramp(tmax, E₀, f, name)\n\nThe field amplitude of a ramp is defined as\n\nF(t) = begincases\nE_0f(tau)  0 leq t_textrmmax \n0 textrmelse\nendcases\nimplies\nA(t) = begincases\n-E_0t_textrmmaxf(tau)  0 leq t leq t_textrmmax\nA(t_textrmmax)  t_textrmmax  t\n0  textrmelse\nendcases\nquad\ntau = fractt_textrmmax\n\nTo define a new ramp, one thus only needs to define one function on the unit interval, f(tau) whose derivative f(tau) rises from 0 to 1. Similar to ConstantField, Ramp is a non-propagating field, but is realizable in e.g. a capacitor.\n\nThree kinds of ramps are predefined, :linear_ramp, :parabolic_ramp, :sin²_ramp (with the alias :sin2_ramp).\n\nExamples\n\njulia> @field(F) do\n           E₀ = 1.0\n           tmax = 4.0u\"fs\"\n           kind = :sin²_ramp\n       end\nsin² up-ramp of\n  - 165.3655 jiffies = 4.0000 fs duration, and\n  - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n\njulia> @field(F) do\n           E₀ = 1.0\n           tmax = 4.0u\"fs\"\n           kind = :linear_ramp\n           ramp = :down\n       end\nLinear down-ramp of\n  - 165.3655 jiffies = 4.0000 fs duration, and\n  - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n\n\n\n\n\n","category":"type"},{"location":"field_types/#Arithmetic","page":"Field types","title":"Arithmetic","text":"","category":"section"},{"location":"field_types/","page":"Field types","title":"Field types","text":"ElectricFields.SumField\nElectricFields.WrappedField\nElectricFields.NegatedField\nElectricFields.DelayedField\ndelay\nElectricFields.PaddedField\nElectricFields.WindowedField\nElectricFields.phase_shift","category":"page"},{"location":"field_types/#ElectricFields.SumField","page":"Field types","title":"ElectricFields.SumField","text":"SumField(a, b)\n\nThe linear combination of two fields a and b.\n\nExample\n\njulia> @field(A) do\n           I₀ = 1.0\n           T = 2.0\n           σ = 3.0\n           Tmax = 3.0\n       end\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n\njulia> @field(B) do\n           I₀ = 0.5\n           T = 1.0\n           σ = 3.0\n           Tmax = 3.0\n       end\nLinearly polarized field with\n  - I₀ = 5.0000e-01 au = 1.7547226e16 W cm^-2 =>\n    - E₀ = 7.0711e-01 au = 363.6089 GV m^-1\n    - A₀ = 0.1125 au\n  – a Fixed carrier @ λ = 7.2516 nm (T = 24.1888 as, ω = 6.2832 Ha = 170.9742 eV, f = 41.3414 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±1.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 8.5598 Bohr = 452.9627 pm\n  – Uₚ = 0.0032 Ha = 86.1591 meV => α = 0.0179 Bohr = 947.8211 fm\n\njulia> A+B\n┌ Linearly polarized field with\n│   - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n│     - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n│     - A₀ = 0.3183 au\n│   – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n│   – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n│   – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n│   – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n⊕\n│ Linearly polarized field with\n│   - I₀ = 5.0000e-01 au = 1.7547226e16 W cm^-2 =>\n│     - E₀ = 7.0711e-01 au = 363.6089 GV m^-1\n│     - A₀ = 0.1125 au\n│   – a Fixed carrier @ λ = 7.2516 nm (T = 24.1888 as, ω = 6.2832 Ha = 170.9742 eV, f = 41.3414 PHz)\n│   – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±1.00σ)\n│   – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 8.5598 Bohr = 452.9627 pm\n└   – Uₚ = 0.0032 Ha = 86.1591 meV => α = 0.0179 Bohr = 947.8211 fm\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.WrappedField","page":"Field types","title":"ElectricFields.WrappedField","text":"WrappedField\n\nWrapper around any electric field\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.NegatedField","page":"Field types","title":"ElectricFields.NegatedField","text":"NegatedField(a)\n\nRepresents a field whose vector_potential is the negative of that of a.\n\nExample\n\njulia> @field(A) do\n           I₀ = 1.0\n           T = 2.0\n           σ = 3.0\n           Tmax = 3.0\n       end\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n\njulia> B = -A\nElectricFields.NegatedField{ElectricFields.LinearField{ElectricFields.FixedCarrier{Quantity{Float64, 𝐋, Unitful.FreeUnits{(Eₕ^-1, ħ, c), 𝐋, nothing}}, Quantity{Float64, 𝐓, Unitful.FreeUnits{(Eₕ^-1, ħ), 𝐓, nothing}}, Float64, Int64}, ElectricFields.GaussianEnvelope{Float64}, Float64}}(Linearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm)\n\njulia> field_amplitude(A, 0.5)\n0.008830294133325867\n\njulia> field_amplitude(B, 0.5)\n-0.008830294133325867\n\njulia> field_amplitude(A-A, 0.5)\n0.0\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.DelayedField","page":"Field types","title":"ElectricFields.DelayedField","text":"DelayedField(a, t₀)\n\nRepresents a delayed copy of a, that appears at time t₀ instead of at 0, i.e. t₀>0 implies the field comes later.\n\nExamples\n\njulia> @field(A) do\n           I₀ = 1.0\n           T = 2.0\n           σ = 3.0\n           Tmax = 3.0\n       end\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n\njulia> delay(A, 1u\"fs\")\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n  – delayed by 41.3414 jiffies = 1.0000 fs\n\njulia> delay(A, 1.0)\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n  – delayed by 1.0000 jiffies = 24.1888 as\n\njulia> delay(A, π*u\"rad\")\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n  – delayed by 1.0000 jiffies = 24.1888 as\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.delay","page":"Field types","title":"ElectricFields.delay","text":"delay(a, t₀)\n\nDelay the field a by the time t₀.\n\n\n\n\n\ndelay(a, ϕ)\n\nDelay the field a by the phase ϕ with respect to its period.\n\n\n\n\n\ndelay(a)\n\nReturn the delay of the field a.\n\n\n\n\n\n","category":"function"},{"location":"field_types/#ElectricFields.PaddedField","page":"Field types","title":"ElectricFields.PaddedField","text":"  PaddedField(field, a, b)\n\nWrapper around any electric field, padded with a units of time before, and b units of time after the ordinary span of the field.\n\nExample\n\njulia> @field(A) do\n           I₀ = 1.0\n           T = 2.0\n           σ = 3.0\n           Tmax = 3.0\n       end\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n\njulia> B = PaddedField(A, 10.0, 30.0)\nPadding before 10.0000 jiffies = 241.8884 as and after 30.0000 jiffies = 725.6653 as of\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n\njulia> span(A), span(B)\n(-6.0 .. 6.0, -16.0 .. 36.0)\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.WindowedField","page":"Field types","title":"ElectricFields.WindowedField","text":"WindowedField(field, a, b)\n\nWrapper around any electric field, windowed such that it is zero outside the time interval a..b.\n\nExample\n\njulia> @field(A) do\n           I₀ = 1.0\n           T = 2.0\n           σ = 3.0\n           Tmax = 3.0\n       end\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n\njulia> B = WindowedField(A, -3, 5)\nWindow from -3.0000 jiffies = -72.5665 as to 5.0000 jiffies = 120.9442 as of\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.3183 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0253 Ha = 689.2724 meV => α = 0.1013 Bohr = 5.3617 pm\n\njulia> span(A), span(B)\n(-6.0 .. 6.0, -3.0 .. 5.0)\n\njulia> field_amplitude(A, -4)\n-0.6395632362683398\n\njulia> field_amplitude(B, -4)\n0.0\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.phase_shift","page":"Field types","title":"ElectricFields.phase_shift","text":"phase_shift(f, δϕ)\n\nReturn a new field whose carrier has been phase-shifted by δϕ.\n\n\n\n\n\n","category":"function"},{"location":"field_types/#Apodizing-Windows","page":"Field types","title":"Apodizing Windows","text":"","category":"section"},{"location":"field_types/","page":"Field types","title":"Field types","text":"This is a generalization of ElectricFields.WindowedField, where the field is multiplied by an apodizing window, that tapers of towards the boundaries, and typically (but not always) is zero at the boundaries. The window functions are non-zero on the interval -1212, so if other intervals are desired, they will need to be rescaled. This happens automatically.","category":"page"},{"location":"field_types/","page":"Field types","title":"Field types","text":"Since the apodizing window is multiplied with the vector potential, the field amplitude gains an extra term due to the chain rule:","category":"page"},{"location":"field_types/","page":"Field types","title":"Field types","text":"vecA_w(t) =\nW(t)vecA(t)\nimplies\nvecF_w(t) =\n-partial_t\nvecA_w(t) =\nW(t)vecF(t) -\nW(t)vecA(t)","category":"page"},{"location":"field_types/#Usage","page":"Field types","title":"Usage","text":"","category":"section"},{"location":"field_types/","page":"Field types","title":"Field types","text":"julia> @field(F) do\n           ω = 1.0\n           I₀ = 1.0\n           ramp = 0.0\n           flat = 3.0\n           env = :tophat\n       end\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹\n    - A₀ = 1.0000 au\n  – a Fixed carrier @ λ = 45.5634 nm (T = 151.9830 as, ω = 1.0000 Ha = 27.2114 eV, f = 6.5797 PHz)\n  – and a /0‾3‾0\\ cycles trapezoidal envelope\n  – and a bandwidth of Inf Ha = Inf eV ⟺ Inf Hz ⟺ Inf Bohr = Inf m\n  – Uₚ = 0.2500 Ha = 6.8028 eV => α = 1.0000 Bohr = 52.9177 pm\n\njulia> Fw = ApodizedField(F, 1.0, 14.0, ElectricFields.Kaiser(3))\nKaiser(α = 3) window from 1.0000 jiffies = 24.1888 as to 14.0000 jiffies = 338.6438 as of\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹\n    - A₀ = 1.0000 au\n  – a Fixed carrier @ λ = 45.5634 nm (T = 151.9830 as, ω = 1.0000 Ha = 27.2114 eV, f = 6.5797 PHz)\n  – and a /0‾3‾0\\ cycles trapezoidal envelope\n  – and a bandwidth of Inf Ha = Inf eV ⟺ Inf Hz ⟺ Inf Bohr = Inf m\n  – Uₚ = 0.2500 Ha = 6.8028 eV => α = 1.0000 Bohr = 52.9177 pm","category":"page"},{"location":"field_types/","page":"Field types","title":"Field types","text":"(Image: Apodized field)","category":"page"},{"location":"field_types/","page":"Field types","title":"Field types","text":"ApodizedField\nspan(::ApodizedField)","category":"page"},{"location":"field_types/#ElectricFields.ApodizedField","page":"Field types","title":"ElectricFields.ApodizedField","text":"ApodizedField(field, a, b, window)\n\nA wrapper that provides an wrapped version of field, apodized by window on the interval a .. b. See AbstractWindow.\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.span-Tuple{ApodizedField}","page":"Field types","title":"ElectricFields.span","text":"span(f::ApodizedField)\n\nThe span of f is given by the intersection of span(parent(f)) and the apodizing interval a .. b.\n\n\n\n\n\n","category":"method"},{"location":"field_types/#Windows","page":"Field types","title":"Windows","text":"","category":"section"},{"location":"field_types/","page":"Field types","title":"Field types","text":"See the Wikipedia page on apodizing windows for the formal definitions of the windows and their frequency responses.","category":"page"},{"location":"field_types/","page":"Field types","title":"Field types","text":"(Image: Apodizing windows)","category":"page"},{"location":"field_types/","page":"Field types","title":"Field types","text":"ElectricFields.AbstractWindow\nElectricFields.Rect\nElectricFields.Hann\nElectricFields.Hamming\nElectricFields.Blackman\nElectricFields.BlackmanExact\nElectricFields.Nuttall\nElectricFields.BlackmanNuttall\nElectricFields.BlackmanHarris\nElectricFields.Kaiser","category":"page"},{"location":"field_types/#ElectricFields.AbstractWindow","page":"Field types","title":"ElectricFields.AbstractWindow","text":"AbstractWindow\n\nBase type of all apodizing windows.\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.Rect","page":"Field types","title":"ElectricFields.Rect","text":"Rect\n\nRectangular window:\n\nW(x) = begincases\n1  x le frac12 \n0  textrmelse\nendcases\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.Hann","page":"Field types","title":"ElectricFields.Hann","text":"ElectricFields.Hann\n\nHann is a sum-of-cosines window, with the terms\n\nW(x) = 05 + 05cos(2 pi x)\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.Hamming","page":"Field types","title":"ElectricFields.Hamming","text":"ElectricFields.Hamming\n\nHamming is a sum-of-cosines window, with the terms\n\nW(x) = 05434782608695652 + 045652173913043476cos(2 pi x)\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.Blackman","page":"Field types","title":"ElectricFields.Blackman","text":"ElectricFields.Blackman\n\nBlackman is a sum-of-cosines window, with the terms\n\nW(x) = 042 + 05cos(2 pi x) + 008cos(4 pi x)\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.BlackmanExact","page":"Field types","title":"ElectricFields.BlackmanExact","text":"ElectricFields.BlackmanExact\n\nBlackman exact is a sum-of-cosines window, with the terms\n\nW(x) = 04265907136715391 + 04965606190885641cos(2 pi x) + 007684866723989682cos(4 pi x)\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.Nuttall","page":"Field types","title":"ElectricFields.Nuttall","text":"ElectricFields.Nuttall\n\nNuttall is a sum-of-cosines window, with the terms\n\nW(x) = 0355768 + 0487396cos(2 pi x) + 0144232cos(4 pi x) + 0012604cos(6 pi x)\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.BlackmanNuttall","page":"Field types","title":"ElectricFields.BlackmanNuttall","text":"ElectricFields.BlackmanNuttall\n\nBlackman–Nuttall is a sum-of-cosines window, with the terms\n\nW(x) = 03635819 + 04891775cos(2 pi x) + 01365995cos(4 pi x) + 00106411cos(6 pi x)\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.BlackmanHarris","page":"Field types","title":"ElectricFields.BlackmanHarris","text":"ElectricFields.BlackmanHarris\n\nBlackman–Harris is a sum-of-cosines window, with the terms\n\nW(x) = 035875 + 048829cos(2 pi x) + 014128cos(4 pi x) + 001168cos(6 pi x)\n\n\n\n\n\n","category":"type"},{"location":"field_types/#ElectricFields.Kaiser","page":"Field types","title":"ElectricFields.Kaiser","text":"Kaiser(α)\n\nW(x) = fracI_0leftpialphasqrt1 - (2x)^2rightI_0(pialpha)\n\nwhere I_0 is the 0th order modified Bessel function of the first kind.\n\n\n\n\n\n","category":"type"},{"location":"interface/#Interface","page":"Interface","title":"Interface","text":"","category":"section"},{"location":"interface/#Creation","page":"Interface","title":"Creation","text":"","category":"section"},{"location":"interface/","page":"Interface","title":"Interface","text":"ElectricFields.@field","category":"page"},{"location":"interface/#ElectricFields.@field","page":"Interface","title":"ElectricFields.@field","text":"@field(name) do ... end\n\nFrontend macro for creating an electric field and storing it in the variable name.\n\nExample\n\njulia> @field(F) do\n           I₀ = 2.0\n           T = 2.0\n           σ = 3.0\n           Tmax = 3.0\n       end\nLinearly polarized field with\n  - I₀ = 2.0000e+00 au = 7.0188904e16 W cm⁻² =>\n    - E₀ = 1.4142e+00 au = 727.2178 GV m⁻¹\n    - A₀ = 0.4502 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n\n\n\n\n\n","category":"macro"},{"location":"interface/#Time-dependent-quantities","page":"Interface","title":"Time-dependent quantities","text":"","category":"section"},{"location":"interface/","page":"Interface","title":"Interface","text":"ElectricFields.field_amplitude\nElectricFields.vector_potential\nElectricFields.instantaneous_intensity\nElectricFields.intensity(::LinearPolarization, f, t::Number; kwargs...)\nElectricFields.field_envelope\nElectricFields.span\nElectricFields.timeaxis\nElectricFields.steps","category":"page"},{"location":"interface/#ElectricFields.field_amplitude","page":"Interface","title":"ElectricFields.field_amplitude","text":"field_amplitude(f, t)\n\nCompute the field amplitude from the vector_potential A(t) using automatic differentiation according to\n\nF(t) = -partial_t A(t)\n\n\n\n\n\nfield_amplitude(f, a, b)\n\nCompute the time integral of the field amplitude according to\n\nint_a^bdifftF(t) = -A(b) - A(a)\n\nwhere A(t) is the vector_potential.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.vector_potential","page":"Interface","title":"ElectricFields.vector_potential","text":"vector_potential(f, t)\n\nCompute the vector potential vecA(t) of the field f.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.instantaneous_intensity","page":"Interface","title":"ElectricFields.instantaneous_intensity","text":"instantaneous_intensity(f, t)\n\nCompute the instantaneous intensity of the field f as\n\nI_i(t) = absF(t)^2 = abs-partial_t A(t)^2\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.intensity-Tuple{LinearPolarization, Any, Number}","page":"Interface","title":"ElectricFields.intensity","text":"intensity(f, t)\n\nCompute the time-dependent intensity of the field f by phase-shifting the carrier continuously until the maximum instantaneous_intensity is achieved.\n\n\n\n\n\n","category":"method"},{"location":"interface/#ElectricFields.field_envelope","page":"Interface","title":"ElectricFields.field_envelope","text":"field_envelope(f, t)\n\nCompute the field amplitude envelope as the square root of intensity.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.span","page":"Interface","title":"ElectricFields.span","text":"span(f)\n\nReturn the end-points for the envelope of the field f.\n\n\n\n\n\nspan(f::ApodizedField)\n\nThe span of f is given by the intersection of span(parent(f)) and the apodizing interval a .. b.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.timeaxis","page":"Interface","title":"ElectricFields.timeaxis","text":"timeaxis(f[, fs])\n\nConstruct a time axis for the field f, covering the span of the envelope in the number of steps given by the sample frequency fs.\n\n\n\n\n\ntimeaxis(f, (N,dt))\n\nAlternate interface that constructs the time axis with N steps starting from first(span(f)), with intervals of dt.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.steps","page":"Interface","title":"ElectricFields.steps","text":"steps(f[, fs])\n\nReturn number of time steps for the field f, optionally supplying a sampling frequency.\n\nWe construct the time axis such that the highest frequency component of the field is resolved. By the Nyquist sampling theorem, we need minimum f_s2f_textrmmax, but to be on the safe side, we use, as default, f_s=100f_textrmmax. This also makes plots nicer.\n\nIf fs<:Integer, the sampling frequency is computed as fs/T, i.e. fs steps per cycle.\n\n\n\n\n\n","category":"function"},{"location":"interface/#Spectra","page":"Interface","title":"Spectra","text":"","category":"section"},{"location":"interface/","page":"Interface","title":"Interface","text":"ElectricFields.spectrum\nElectricFields.field_amplitude_spectrum\nElectricFields.vector_potential_spectrum\nElectricFields.AbstractFFTs.fft\nElectricFields.nfft\nElectricFields.fft_vector_potential\nElectricFields.nfft_vector_potential\nElectricFields.fftω\nElectricFields.AbstractFFTs.rfft\nElectricFields.AbstractFFTs.irfft\nElectricFields.rfft_vector_potential\nElectricFields.rfftω","category":"page"},{"location":"interface/#ElectricFields.spectrum","page":"Interface","title":"ElectricFields.spectrum","text":"spectrum(env::AbstractGaussianEnvelope)\n\nGaussians belong to the Schwartz class, i.e. functions who, under Fourier transform, are mapped back to the same space. That is to say, the Fourier transform of a Gaussian is a Gaussian:\n\nexp(-alpha t^2) leftrightarrow\nfrac1sqrt2alpha\nexpleft(-fracomega^24alpharight)\n\nComparing with the above, we find that the spectral standard deviation\n\nOmega = sqrt2alpha = frac2sqrtln 2tau\n\nand the Gaussian function in the spectral domain is thus\n\nE(omega) =\nfracE_0tau2sqrtln 2\nexpleft-frac(omegatau)^28ln2right\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.field_amplitude_spectrum","page":"Interface","title":"ElectricFields.field_amplitude_spectrum","text":"field_amplitude_spectrum(f::AbstractField, ω)\n\nCompute the analytic Fourier transform of the field_amplitude of the field f at the angular frequency ω, using the Fourier identity\n\nvecF(t) = -partial_t vecA(t)\niff\nhatvecF(omega) = -imomega hatvecA(omega)\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.vector_potential_spectrum","page":"Interface","title":"ElectricFields.vector_potential_spectrum","text":"vector_potential_spectrum(f::AbstractField, ω)\n\nCompute the analytic Fourier transform of the vector_potential of the field f at the angular frequency ω.\n\n\n\n\n\n","category":"function"},{"location":"interface/#AbstractFFTs.fft","page":"Interface","title":"AbstractFFTs.fft","text":"fft(f::AbstractField, t::AbstractRange)\n\nCompute the FFT of the field_amplitude of the field f sampled on the uniform temporal grid t.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.nfft","page":"Interface","title":"ElectricFields.nfft","text":"nfft(y, ts...)\n\nNormalized FFT of y with respect to the axes ts. We use the symmetric normalization (2pi)^-N2 where N is the number of dimensions.\n\n\n\n\n\nnfft(f::AbstractField, t::AbstractRange)\n\nCompute the symmetrically normalized FFT of the field_amplitude of the field f sampled on the uniform temporal grid t.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.fft_vector_potential","page":"Interface","title":"ElectricFields.fft_vector_potential","text":"fft_vector_potential(f::AbstractField, t::AbstractRange)\n\nCompute the FFT of the vector_potential of the field f sampled on the uniform temporal grid t.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.nfft_vector_potential","page":"Interface","title":"ElectricFields.nfft_vector_potential","text":"nfft_vector_potential(f::AbstractField, t::AbstractRange)\n\nCompute the symmetrically normalized FFT of the vector_potential of the field f sampled on the uniform temporal grid t.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.fftω","page":"Interface","title":"ElectricFields.fftω","text":"fftω(t::AbstractRange)\n\nReturn the angular frequency grid corresponding to uniform sampling in time with the tempolar grid t.\n\n\n\n\n\n","category":"function"},{"location":"interface/#AbstractFFTs.rfft","page":"Interface","title":"AbstractFFTs.rfft","text":"rfft(f::AbstractField, t::AbstractRange)\n\nCompute the RFFT of the field_amplitude of the field f sampled on the uniform temporal grid t, in the case of real-valued signals.\n\n\n\n\n\n","category":"function"},{"location":"interface/#AbstractFFTs.irfft","page":"Interface","title":"AbstractFFTs.irfft","text":"irfft(F, t)\n\nCompute the IRFFT of the spectral amplitudes F, with the end-result resolved on the time axis t, in the case of real-valued signals.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.rfft_vector_potential","page":"Interface","title":"ElectricFields.rfft_vector_potential","text":"rfft_vector_potential(f::AbstractField, t::AbstractRange)\n\nCompute the RFFT of the vector_potential of the field f sampled on the uniform temporal grid t, in the case of real-valued signals.\n\n\n\n\n\n","category":"function"},{"location":"interface/#ElectricFields.rfftω","page":"Interface","title":"ElectricFields.rfftω","text":"rfftω(t::AbstractRange)\n\nReturn the angular frequency grid corresponding to uniform sampling in time with the tempolar grid t, in the case of real-valued signals.\n\n\n\n\n\n","category":"function"},{"location":"carriers/#Carriers","page":"Carriers","title":"Carriers","text":"","category":"section"},{"location":"carriers/","page":"Carriers","title":"Carriers","text":"ElectricFields.AbstractCarrier\nElectricFields.LinearCarrier\nElectricFields.FixedCarrier\nElectricFields.TransverseCarrier\nElectricFields.LinearTransverseCarrier\nElectricFields.EllipticalCarrier","category":"page"},{"location":"carriers/#ElectricFields.AbstractCarrier","page":"Carriers","title":"ElectricFields.AbstractCarrier","text":"AbstractCarrier\n\nAny carrier, of any dimensionality.\n\n\n\n\n\n","category":"type"},{"location":"carriers/#ElectricFields.LinearCarrier","page":"Carriers","title":"ElectricFields.LinearCarrier","text":"LinearCarrier <: AbstractCarrier\n\nAny carrier which is one-dimensional, i.e. linearly polarized (by convention along z).\n\n\n\n\n\n","category":"type"},{"location":"carriers/#ElectricFields.FixedCarrier","page":"Carriers","title":"ElectricFields.FixedCarrier","text":"FixedCarrier <: LinearCarrier\n\nThe carrier is fixed in the sense that the instantaneous frequency is constant throughout the pulse, i.e. no chirp/dispersion:\n\nImexpim(omega t + phi) = sin(omega t + phi)\n\n\n\n\n\n","category":"type"},{"location":"carriers/#ElectricFields.TransverseCarrier","page":"Carriers","title":"ElectricFields.TransverseCarrier","text":"TransverseCarrier <: AbstractCarrier\n\nAny carrier which is two-dimensional, i.e. polarized in the plane perpendicular to the direction of propagation.\n\n\n\n\n\n","category":"type"},{"location":"carriers/#ElectricFields.LinearTransverseCarrier","page":"Carriers","title":"ElectricFields.LinearTransverseCarrier","text":"LinearTransverseCarrier\n\nThe carrier is identical to FixedCarrier, but explicitly in 3d, with the polarization taken along the z axis:\n\nvecC(t) = bmat00sin(omega t + phi)\n\n\n\n\n\n","category":"type"},{"location":"carriers/#ElectricFields.EllipticalCarrier","page":"Carriers","title":"ElectricFields.EllipticalCarrier","text":"EllipticalCarrier\n\nAn elliptically polarized field (of which circularly and linearly polarized are special cases) is given in the canonical coordinate system as\n\nvecC(t) = frac1sqrt1+xi^2\nbmatxicostheta0sintheta\nquad\ntheta defd omega t + phi\n\ni.e. with the principal axis of the ellipse along z.\n\n\n\n\n\n","category":"type"},{"location":"envelopes/#Envelopes","page":"Envelopes","title":"Envelopes","text":"","category":"section"},{"location":"envelopes/","page":"Envelopes","title":"Envelopes","text":"The various envelopes require different parameters to be specified in the @field creation macro; they are listed below with σ|τ implying that either σ or τ is required.","category":"page"},{"location":"envelopes/","page":"Envelopes","title":"Envelopes","text":"ElectricFields.GaussianEnvelope\nElectricFields.TruncatedGaussianEnvelope\nElectricFields.TrapezoidalEnvelope\nElectricFields.Cos²Envelope","category":"page"},{"location":"envelopes/#ElectricFields.GaussianEnvelope","page":"Envelopes","title":"ElectricFields.GaussianEnvelope","text":"GaussianEnvelope\n\nA Gaussian pulse is given by\n\nf(t) = expleft(-fract^22sigma^2right)\n\nwhere the standard deviation σ is related to the FWHM duration τ of the intensity envelope as\n\nsigma = fractau2sqrt2ln 2\n\nSince we define all fields in terms of the vector potential A(t), and the instantaneous_intensity is given by abs-partial_t A(t)^2, we have to find a coefficient α such that the field amplitude\n\nF(t) sim -partial_t exp(-alpha t^2) sin(omega t + phi)\n\nhas an intensity envelope with the desired FWHM; we do this iteratively in gaussian_common!. This is mainly important for ultrashort pulses, since for long pulse durations we can approximate exp(-alpha t^2) sim 1 such that only the carrier contributes to the time derivative.\n\nSince a Gaussian never ends, we specify how many σ we require; the resulting time window will be rounded up to an integer amount of cycles of the fundamental.\n\nRequired parameters:\n\nλ|T|f|ν|ω|ħω,\nτ|σ|α,\nσmax|tmax|Tmax,\nenv=:gauss (optional, since GaussianEnvelope is the default envelope).\n\n\n\n\n\n","category":"type"},{"location":"envelopes/#ElectricFields.TruncatedGaussianEnvelope","page":"Envelopes","title":"ElectricFields.TruncatedGaussianEnvelope","text":"TruncatedGaussianEnvelope\n\nSince a Gaussian function never ends, this envelope adds a soft truncation over a time interval:\n\nf(t)=\nbegincases\nexp(-alpha t^2)  abst leq t_textrmoff\nexpleft\n-alphaleft\nt_textrmoff + frac2pi(t_textrmmax - t_textrmoff)\ntanleft(\nfracpi2\nfracabst - t_textrmofft_textrmmax - t_textrmoff\nright)\nright^2\nright\n t_textrmoff  abst leq t_textrmmax \n0  t_textrmmax  abst\nendcases\n\nThis is Eq. (72) of\n\nPatchkovskii, S., & Muller, H. (2016). Simple, accurate, and efficient implementation of 1-electron atomic time-dependent Schrödinger equation in spherical coordinates. Computer Physics Communications, 199, 153–169. 10.1016/j.cpc.2015.10.014\n\nRequired parameters:\n\nλ|T|f|ν|ω|ħω,\nτ|σ|α,\ntoff,\nσmax|tmax|Tmax,\n\nenv=:trunc_gauss.\n\nBeyond this, everything else is the same as for GaussianEnvelope.\n\n\n\n\n\n","category":"type"},{"location":"envelopes/#ElectricFields.TrapezoidalEnvelope","page":"Envelopes","title":"ElectricFields.TrapezoidalEnvelope","text":"TrapezoidalEnvelope\n\nThis is a very simple piecewise linear function:\n\nf(t)=\nbegincases\nrr_textrmup\n 0 leq r  r_textrmup\n1\n r_textrmup leq r  r_textrmup + r_textrmflat \n1 - fracr-r_textrmup-r_textrmflatr_textrmdown\n r_textrmup + r_textrmflat leq r  r_textrmup + r_textrmflat + r_textrmdown \n0\n textrmelse\nendcases\nquad\nr defd tT\n\nwhere T is the period time of the carrier.\n\nRequired parameters:\n\nλ|T|f|ν|ω|ħω,\nramp | (ramp_up & ramp_down),\nflat,\nenv=:trapezoidal | env=:tophat.\n\nBeware that this envelope can introduce artifacts at the ends of the pulse, such that the electric field is non-vanishing, depending of e.g. the phase of the carrier.\n\nThe shape of the ramp can be influenced by chaining gf(t), where g(x) should map smoothly to 01 for xin01. Currently implemented ramps are\n\nramp_kind = :linear implies g(x) = x (default)\nramp_kind = :sin² | ramp_kind = :sin2 implies g(x) = sin^2(pi x2)\n\n\n\n\n\n","category":"type"},{"location":"envelopes/#ElectricFields.Cos²Envelope","page":"Envelopes","title":"ElectricFields.Cos²Envelope","text":"Cos²Envelope\n\nf(t) = begincases\ncos^2 left(fracpi tcTright)\n -1 leq t(cT) leq 1\n0  textrmelse\nendcases\n\nwhere c is the number of cycles from zero to zero of the cos^2 envelope and T the period time.\n\nRequired parameters:\n\nλ|T|f|ν|ω|ħω,\ncycles,\nenv=:cos² | env=:cos2.\n\n\n\n\n\n","category":"type"},{"location":"properties/#Field-properties","page":"Field properties","title":"Field properties","text":"","category":"section"},{"location":"properties/","page":"Field properties","title":"Field properties","text":"wavelength\nperiod\nfrequency\nmax_frequency\nwavenumber\nphoton_energy\nduration\ntime_bandwidth_product\ncontinuity\nfluence\nintensity\namplitude\ncarrier\nenvelope\nphase\ndimensions\npolarization","category":"page"},{"location":"properties/#ElectricFields.wavelength","page":"Field properties","title":"ElectricFields.wavelength","text":"wavelength(f)\n\nReturn the carrier wavelength lambda of f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.period","page":"Field properties","title":"ElectricFields.period","text":"period(f)\n\nReturn the carrier period time T of f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.frequency","page":"Field properties","title":"ElectricFields.frequency","text":"frequency(f)\n\nReturn the carrier frequency f of the field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.max_frequency","page":"Field properties","title":"ElectricFields.max_frequency","text":"max_frequency(f)\n\nReturn the maximum carrier frequency f in case of a composite field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.wavenumber","page":"Field properties","title":"ElectricFields.wavenumber","text":"wavenumber(f)\n\nReturn the carrier wavenumber nu of the field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.photon_energy","page":"Field properties","title":"ElectricFields.photon_energy","text":"photon_energy(f)\n\nReturn the carrier photon energy hbaromega of the field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.duration","page":"Field properties","title":"ElectricFields.duration","text":"duration(f)\n\nReturn the pulse duration tau of the field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.time_bandwidth_product","page":"Field properties","title":"ElectricFields.time_bandwidth_product","text":"time_bandwidth_product(f)\n\nReturn the time–bandwidth product of the field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.continuity","page":"Field properties","title":"ElectricFields.continuity","text":"continuity(f)\n\nReturn the pulse continuity, i.e. differentiability, of the field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.fluence","page":"Field properties","title":"ElectricFields.fluence","text":"fluence(f)\n\nCompute the fluence of the field f, i.e.\n\nfrac1hbaromega\nintdifft I(t)\n\nwhere I(t) is the intensity envelope of the pulse.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.intensity","page":"Field properties","title":"ElectricFields.intensity","text":"intensity(f)\n\nReturn the peak intensity of the field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.amplitude","page":"Field properties","title":"ElectricFields.amplitude","text":"amplitude(f)\n\nReturn the peak amplitude of the field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.carrier","page":"Field properties","title":"ElectricFields.carrier","text":"carrier(f)\n\nReturn the carrier of the field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.envelope","page":"Field properties","title":"ElectricFields.envelope","text":"envelope(f)\n\nReturn the envelope of the field f.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.phase","page":"Field properties","title":"ElectricFields.phase","text":"phase(c)\n\nReturn the phase of the carrier c.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.dimensions","page":"Field properties","title":"ElectricFields.dimensions","text":"dimensions(f)\n\nReturn the number of dimensions of the field f. See also polarization.\n\nExamples\n\njulia> @field(F) do\n           I₀ = 2.0\n           T = 2.0\n           σ = 3.0\n           Tmax = 3.0\n       end\nLinearly polarized field with\n  - I₀ = 2.0000e+00 au = 7.0188904e16 W cm^-2 =>\n    - E₀ = 1.4142e+00 au = 727.2178 GV m^-1\n    - A₀ = 0.4502 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0507 Ha = 1.3785 eV => α = 0.1433 Bohr = 7.5826 pm\n\njulia> dimensions(F)\n1\n\njulia> @field(F) do\n           I₀ = 2.0\n           T = 2.0\n           σ = 3.0\n           Tmax = 3.0\n           ξ = 1.0\n       end\nTransversely polarized field with\n  - I₀ = 2.0000e+00 au = 7.0188904e16 W cm^-2 =>\n    - E₀ = 1.4142e+00 au = 727.2178 GV m^-1\n    - A₀ = 0.4502 au\n  – a Elliptical carrier with ξ = 1.00 (RCP) @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0507 Ha = 1.3785 eV => α = 0.1433 Bohr = 7.5826 pm\n\njulia> dimensions(F)\n3\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.polarization","page":"Field properties","title":"ElectricFields.polarization","text":"polarization(f)\n\nReturn the polarization kind of the field f. See also dimensions.\n\nExamples\n\njulia> @field(F) do\n           I₀ = 2.0\n           T = 2.0\n           σ = 3.0\n           Tmax = 3.0\n       end\nLinearly polarized field with\n  - I₀ = 2.0000e+00 au = 7.0188904e16 W cm^-2 =>\n    - E₀ = 1.4142e+00 au = 727.2178 GV m^-1\n    - A₀ = 0.4502 au\n  – a Fixed carrier @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0507 Ha = 1.3785 eV => α = 0.1433 Bohr = 7.5826 pm\n\njulia> polarization(F)\nLinearPolarization()\n\njulia> @field(F) do\n           I₀ = 2.0\n           T = 2.0\n           σ = 3.0\n           Tmax = 3.0\n           ξ = 1.0\n       end\nTransversely polarized field with\n  - I₀ = 2.0000e+00 au = 7.0188904e16 W cm^-2 =>\n    - E₀ = 1.4142e+00 au = 727.2178 GV m^-1\n    - A₀ = 0.4502 au\n  – a Elliptical carrier with ξ = 1.00 (RCP) @ λ = 14.5033 nm (T = 48.3777 as, ω = 3.1416 Ha = 85.4871 eV, f = 20.6707 PHz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±2.00σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 34.2390 Bohr = 1.8119 nm\n  – Uₚ = 0.0507 Ha = 1.3785 eV => α = 0.1433 Bohr = 7.5826 pm\n\njulia> polarization(F)\nArbitraryPolarization()\n\n\n\n\n\n","category":"function"},{"location":"properties/#Strong-field-properties","page":"Field properties","title":"Strong-field properties","text":"","category":"section"},{"location":"properties/","page":"Field properties","title":"Field properties","text":"ponderomotive_potential\nkeldysh\nfree_oscillation_amplitude","category":"page"},{"location":"properties/#ElectricFields.ponderomotive_potential","page":"Field properties","title":"ElectricFields.ponderomotive_potential","text":"ponderomotive_potential(f)\n\nReturn the ponderomotive potential U_p, which is the cycle-average quiver energy of a free electron in an electromagnetic field f. It is given by\n\nU_p =\nfrace^2E_0^24momega^2=frac2e^2cvarepsilon_0mtimesfracI4omega^2\n\nor, in atomic units,\n\nU_p = fracI4omega^2\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.keldysh","page":"Field properties","title":"ElectricFields.keldysh","text":"keldysh(f, Iₚ)\n\nThe Keldysh parameter relates the strength of a dynamic electric field to that of the binding potential of an atom. It is given by\n\ngamma = sqrtfracI_p2U_p\n\nwhere I_p is the ionization potential of the atom and U_p is the ponderomotive potential of the dynamic field.\n\n\n\n\n\n","category":"function"},{"location":"properties/#ElectricFields.free_oscillation_amplitude","page":"Field properties","title":"ElectricFields.free_oscillation_amplitude","text":"free_oscillation_amplitude(F)\n\nCompute the free oscillation amplitude of an electric field F, i.e. the mean excursion length during one cycle of the field, defined as\n\nalpha defd fracFomega^2\n\nwhere F is the peak amplitude, i.e. this is defined for one cycle of a monochrome field.\n\n\n\n\n\n","category":"function"},{"location":"dispersion/#Dispersion","page":"Dispersion","title":"Dispersion","text":"","category":"section"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"Dispersion is most easily calculated in the frequency domain, where it simply amounts to multiplication of the spectral amplitudes by a transfer function:","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"hatvecF_2(omega) =\nH(omega)\nhatvecF_1(omega)","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"where H(omega) is the transfer function, hatvecF_1(omega) is the field before dispersion, and hatvecF_2(omega) after. Since hatvecF(omega)equiv-imomegahatvecA(omega), the same relation holds for the vector potential:","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"hatvecA_2(omega) =\nH(omega)\nhatvecA_1(omega)","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"Dispersion is implemented in ElectricFields.jl via the transform pair rfft/irfft:","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"vecA_1t\noversettextttrfftto\nhatvecA_1omega\nto\nhatvecA_2omega =\nHomega\nhatvecA_1omega\noversettextttirfftto\nvecA_2t","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"where the notation t and omega signifies uniformly spaced vectors, since the FFT is a numeric algorithm. Since field_amplitude and vector_potential allow the evaluation of a field at arbitrary time points (and integrals over arbitrary time intervals), we fit vecA_2t to a BSplineField. The next complication is that the transfer function H will in general introduce a temporal spread, such that the compact support of the dispersed field is much wider than that of the original one. We therefore successively increase the time span (using ElectricFields.find_time_span) we evaluate vecA_2t on until it has converged. Before we fit this function to a BSplineField, we truncate the time span again to a window where vecA_2tepsilon.","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"DispersedField","category":"page"},{"location":"dispersion/#ElectricFields.DispersedField","page":"Dispersion","title":"ElectricFields.DispersedField","text":"DispersedField(f, de, B, s)\n\nRepresents the field f dispersed through the DispersiveElement de. Since the dispersion is most efficiently calculated in the frequency domain, this is done via rfft/irfft, and the dispersed field is interpolated as the BSplineField B. The temporal span of the dispersed field is given by s.\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#Simple-dispersive-elements","page":"Dispersion","title":"Simple dispersive elements","text":"","category":"section"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"Any purely dispersive medium (i.e. no loss or gain) can be written as","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"H(omega) = exp-imphi(omega)","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"where the phase can be Taylor-expanded as","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"phi(omega) =\nphi_0 +\na(omega-omega_0) +\nb(omega-omega_0)^2 +\n","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"phi_0 is a PhaseShift, a=2pi t_d amounts to a time delay by t_d (by the Fourier shift theorem), and b introduced a Chirp.","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"julia> @field(F) do\n           λ = 800u\"nm\"\n           I₀ = 1.0\n           τ = 3u\"fs\"\n           σoff = 4.0\n           σmax = 6.0\n           env = :trunc_gauss\n           ϕ = π\n       end\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹\n    - A₀ = 17.5580 au\n  – a Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz); CEP = 1.00π\n  – and a Truncated Gaussian envelope of duration 124.0241 jiffies = 3.0000 fs (intensity FWHM; turn-off from 5.0959 fs to 7.6439 fs)\n  – and a bandwidth of 0.0224 Ha = 608.3170 meV ⟺ 147.0904 THz ⟺ 5933.9307 Bohr = 314.0101 nm\n  – Uₚ = 77.0706 Ha = 2.0972 keV => α = 308.2823 Bohr = 16.3136 nm\n\njulia> Fc = chirp(F, austrip(5u\"fs^2\"), verbosity=4)\n┌ Info: Finding large enough time span to encompass dispersed field\n│   f =\n│    Linearly polarized field with\n│      - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =>\n│        - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹\n│        - A₀ = 17.5580 au\n│      – a Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz); CEP = 1.00π\n│      – and a Truncated Gaussian envelope of duration 124.0241 jiffies = 3.0000 fs (intensity FWHM; turn-off from 5.0959 fs to 7.6439 fs)\n│      – and a bandwidth of 0.0224 Ha = 608.3170 meV ⟺ 147.0904 THz ⟺ 5933.9307 Bohr = 314.0101 nm\n│      – Uₚ = 77.0706 Ha = 2.0972 keV => α = 308.2823 Bohr = 16.3136 nm\n│   de = Chirp(b = 8545.5457 = 5.0000 fs², ω₀ = 0.0570 = 1.5498 eV)\n│   max_iter = 7\n│   ξ = 2.0\n└   tol = 0.0005\n----------------------------------------------------------------------------------------------------\n1\nt′ = -632.0183332958276:1.1049271561115868:633.1232604519392\nR = 2.095947834009663\n----------------------------------------------------------------------------------------------------\n2\nt′ = -1264.0366665916551:1.1049271561115868:1265.1415937477668\nR = 0.16138039790711892\n----------------------------------------------------------------------------------------------------\n3\nt′ = -2528.0733331833103:1.1049271561115868:2529.178260339422\nR = 0.0013929399886955529\n----------------------------------------------------------------------------------------------------\n4\nt′ = -5056.146666366621:1.1049271561115868:5057.251593522733\nR = 0.00012089884366390845\n┌ Info: Truncated to time interval -896.38155595379 .. 888.6605640985183\n│   a = 1480\n│   b = 3098\n│   cutoff = 0.0014901161193847656\n└   abs_cutoff = 0.014115901307391281\n┌ Info: Generated B-spline\n│   num_knots = 324\n└   B = BSpline basis with typename(ElectricFields.LinearKnotSet)(Float64) of order k = 3 (parabolic) on -896.38155595379 .. 888.6605640985183 (324 intervals)\nDispersedField:\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹\n    - A₀ = 17.5580 au\n  – a Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz); CEP = 1.00π\n  – and a Truncated Gaussian envelope of duration 124.0241 jiffies = 3.0000 fs (intensity FWHM; turn-off from 5.0959 fs to 7.6439 fs)\n  – and a bandwidth of 0.0224 Ha = 608.3170 meV ⟺ 147.0904 THz ⟺ 5933.9307 Bohr = 314.0101 nm\n  – Uₚ = 77.0706 Ha = 2.0972 keV => α = 308.2823 Bohr = 16.3136 nm\n  – dispersed through Chirp(b = 8545.5457 = 5.0000 fs², ω₀ = 0.0570 = 1.5498 eV)","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"(Image: Chirped field)","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"In black, we see the original field, in red the chirped field, and the bottom panel shows a Gabor transform of the chirped field, along with horizontal line at the carrier frequency omega_0, and a diagonal line at the expected instantaneous frequency omega=omega_0 + frac12fracbgamma^2 + b^2t, where gamma = fractau^28ln2.","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"ElectricFields.DispersiveElement\nPhaseShift\nphase_shift(f::ElectricFields.AbstractField, ϕ; kwargs...)\nChirp\nchirp\nElectricFields.CascadedDispersiveElement\nElectricFields.find_time_span","category":"page"},{"location":"dispersion/#ElectricFields.DispersiveElement","page":"Dispersion","title":"ElectricFields.DispersiveElement","text":"DispersiveElement\n\nBase type for all dispersive elements\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#ElectricFields.PhaseShift","page":"Dispersion","title":"ElectricFields.PhaseShift","text":"PhaseShift(ϕ)\n\nRepresents a phase shift according to\n\nH(omega) =\nexp(-imphi)\n\nExample\n\njulia> PhaseShift(6)\nPhaseShift(ϕ = 6.0000 rad)\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#ElectricFields.phase_shift-Tuple{ElectricFields.AbstractField, Any}","page":"Dispersion","title":"ElectricFields.phase_shift","text":"phase_shift(f, ϕ)\n\nReturns the field resulting from applying a PhaseShift to the field f.\n\n\n\n\n\n","category":"method"},{"location":"dispersion/#ElectricFields.Chirp","page":"Dispersion","title":"ElectricFields.Chirp","text":"Chirp(b, ω₀)\n\nRepresents chirp according to\n\nH(omega) =\nexp-im b(ω-ω_0)^2\n\nExample\n\njulia> Chirp(austrip(5u\"fs^2\"), austrip(1.5u\"eV\"))\nChirp(b = 8545.5457 = 5.0000 fs², ω₀ = 0.0551 = 1.5000 eV)\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#ElectricFields.chirp","page":"Dispersion","title":"ElectricFields.chirp","text":"chirp(f, b, ω₀=photon_energy(f))\n\nReturns the field resulting from applying a Chirp to the field f.\n\nExample\n\njulia> @field(F) do\n           I₀ = 1.0\n           T = 2.0u\"fs\"\n           σ = 3.0\n           Tmax = 3.0\n       end\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹\n    - A₀ = 13.1594 au\n  – a Fixed carrier @ λ = 599.5849 nm (T = 2.0000 fs, ω = 0.0760 Ha = 2.0678 eV, f = 500.0000 THz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±82.68σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 58518.2144 Bohr = 3.0967 μm\n  – Uₚ = 43.2922 Ha = 1.1780 keV => α = 173.1690 Bohr = 9.1637 nm\n\njulia> chirp(F, austrip(1u\"fs^2\"))\nDispersedField:\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹\n    - A₀ = 13.1594 au\n  – a Fixed carrier @ λ = 599.5849 nm (T = 2.0000 fs, ω = 0.0760 Ha = 2.0678 eV, f = 500.0000 THz)\n  – and a Gaussian envelope of duration 170.8811 as (intensity FWHM; ±82.68σ)\n  – and a bandwidth of 0.3925 Ha = 10.6797 eV ⟺ 2.5823 PHz ⟺ 58518.2144 Bohr = 3.0967 μm\n  – Uₚ = 43.2922 Ha = 1.1780 keV => α = 173.1690 Bohr = 9.1637 nm\n  – dispersed through Chirp(b = 1709.1091 = 1.0000 fs², ω₀ = 0.0760 = 2.0678 eV)\n\n\n\n\n\n","category":"function"},{"location":"dispersion/#ElectricFields.CascadedDispersiveElement","page":"Dispersion","title":"ElectricFields.CascadedDispersiveElement","text":"CascadedDispersiveElement(elements)\n\nRepresents the combination of multiple DispersiveElements.\n\nExample\n\njulia> PhaseShift(6)*Chirp(austrip(5u\"fs^2\"), austrip(1.5u\"eV\"))\n[PhaseShift(ϕ = 6.0000 rad) ∗ Chirp(b = 8545.5457 = 5.0000 fs², ω₀ = 0.0551 = 1.5000 eV)]\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#ElectricFields.find_time_span","page":"Dispersion","title":"ElectricFields.find_time_span","text":"find_time_span(f, de[, fs]; max_iter=10, ξ=2.0, tol)\n\nFind a suitable time span ab such that when f is dispersed through the DispersiveElement de, the compact support of the resulting field is contained in the time interval. This is done by successively multiplying the time span on which F is evaluated ξ before the RFFT, until the IRFFT has converged.\n\n\n\n\n\n","category":"function"},{"location":"dispersion/#Dispersive-media","page":"Dispersion","title":"Dispersive media","text":"","category":"section"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"In addition to the simple, analytic dispersive elements listed above, PhaseShift and Chirp, we also support calculating the dispersion resulting from pulse propagation through a dispersive ElectricFields.Medium, which models a physical medium phenomenologically. Typically, one employs a Sellmeier equation to describe the variation of the refractive index with the wavelength of the incident light, and the compute the dispersion according to","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"H(omega) =\nexp-im k(omega)d","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"where d is the thickness of the medium,","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"k(omega) = n(omega)k_0","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"is the wavevector in the medium with refractive index n(omega). For convenience, we typically subtract the linear component at the carrier energy omega_0 according to","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"tildek(omega) =\nk(omega) -\nomega\nleftfracpartial kpartialomegaright_omega_0","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"to keep the pulse centred in the frame of reference.","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"For an IsotropicMedium, the square of the refractive index, n^2(lambda) does not depend on the direction of polarization. For an anistropic medium, a Crystal, different polarization axes may have different refractive indices. This is modelled using the index ellipsoid[demo], which obeys","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"fracx^2n_a^2 + fracy^2n_b^2 + fracz^2n_c^2 = 1","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"By choosing the orientation of the crystal appropriately (or equivalently rotate the field), we can achieve different dispersion for the different components of the field:","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"julia> @field(F) do\n           λ = 800u\"nm\"\n           I₀ = 1.0\n           τ = 3u\"fs\"\n           σoff = 4.0\n           σmax = 6.0\n           env = :trunc_gauss\n           ϕ = π\n       end;\n\njulia> F = rotate(F, ElectricFields.compute_rotation((π/3, [0.4,1,0])));\n\njulia> de = Crystal(KTP, 12u\"μm\", ω₀=photon_energy(F));\n\njulia> Fc = DispersedField(F, de)\nDispersedField:\nTransversely polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm⁻² =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m⁻¹\n    - A₀ = 17.5580 au\n  – a LinearTransverseCarrier: Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz); CEP = 1.00π\n  – a Truncated Gaussian envelope of duration 124.0241 jiffies = 3.0000 fs (intensity FWHM; turn-off from 5.0959 fs to 7.6439 fs)\n  – and a rotation of 0.33π about [0.371, 0.928, 0.000]\n  – and a bandwidth of 0.0224 Ha = 608.3170 meV ⟺ 147.0904 THz ⟺ 5933.9307 Bohr = 314.0101 nm\n  – Uₚ = 77.0706 Ha = 2.0972 keV => α = 308.2823 Bohr = 16.3136 nm\n  – dispersed through Crystal(226767.13 Bohr = 12.00 μm of Sellmeier{Float64, Float64, Quantity{Float64, 𝐋², Unitful.FreeUnits{(μm²,), 𝐋², nothing}}, Tuple{Quantity{Float64, 𝐋⁻², Unitful.FreeUnits{(μm⁻²,), 𝐋⁻², nothing}}}}[Sellmeier(1.10468, [0.89342], [2], [0.04438 μm²], [-0.01036 μm⁻²], [2]), Sellmeier(1.14559, [0.87629], [2], [0.0485 μm²], [-0.01173 μm⁻²], [2]), Sellmeier(0.9446, [1.3617], [2], [0.047 μm²], [-0.01491 μm⁻²], [2])], R = [1.0 0.0 0.0; 0.0 1.0 0.0; 0.0 0.0 1.0], ∂k∂ω₀ = 0.0134)","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"(Image: Dispersed field)","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"[demo]: Interactive demonstration of the index ellipsoid.","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"ElectricFields.Medium\nIsotropicMedium\nIsotropicMedium(material, d; ω₀=nothing)\nCrystal\nCrystal(material, d, R=I; ω₀=nothing)","category":"page"},{"location":"dispersion/#ElectricFields.Medium","page":"Dispersion","title":"ElectricFields.Medium","text":"Medium\n\nBase type for all dispersive media\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#ElectricFields.IsotropicMedium","page":"Dispersion","title":"ElectricFields.IsotropicMedium","text":"IsotropicMedium(material, d[, ∂k∂ω₀ = 0])\n\nDescribes the dispersion through an isotropic medium of thickness d (such as an atomic gas), where the refractive index, given by material, is the same in all directions.\n\nThe optional ∂k∂ω₀ can be used to subtract the linear slope from the dispersion relation, i.e. remove the time shift, such that a pulse with central angular frequency ω₀ stays centred in the frame of reference.\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#ElectricFields.IsotropicMedium-Tuple{Any, Any}","page":"Dispersion","title":"ElectricFields.IsotropicMedium","text":"IsotropicMedium(material, d; ω₀)\n\nConvenience constructor for IsotropicMedium; if a central angular frequency ω₀ is provided, the linear slope of the dispersion of the material is computed at ω₀. This slope is subsequently subtracted from the dispersion.\n\n\n\n\n\n","category":"method"},{"location":"dispersion/#ElectricFields.Crystal","page":"Dispersion","title":"ElectricFields.Crystal","text":"Crystal(material, d, R[, ∂k∂ω₀ = 0])\n\nDescribes the dispersion through a general crystal of thickness d and orientation given by the rotation R, with different refractive indices, given by the components of material, along the different crystal axes.\n\nIn the special case where material has two components, we have a uniaxial crystal, which is birefringent, and material[1] is referred to as ordinary the refractive index, and material[2] as the extraordinary refractive index.\n\nThe optional ∂k∂ω₀ can be used to subtract the linear slope from the dispersion relation, i.e. remove the time shift, such that a pulse with central angular frequency ω₀ stays centred in the frame of reference.\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#ElectricFields.Crystal-2","page":"Dispersion","title":"ElectricFields.Crystal","text":"Crystal(material, d, R=I; ω₀)\n\nConvenience constructor for Crystal; if a central angular frequency ω₀ is provided, the linear slope of the dispersion of the material is computed at ω₀. This slope is subsequently subtracted from the dispersion.\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#Sellmeier-equations","page":"Dispersion","title":"Sellmeier equations","text":"","category":"section"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"ElectricFields.Sellmeier\nBK7\nSiO₂\nCalcite\nQuartz\nKTP","category":"page"},{"location":"dispersion/#ElectricFields.Sellmeier","page":"Dispersion","title":"ElectricFields.Sellmeier","text":"Sellmeier(A, B, p, C, D, q)\n\nThe Sellmeier equations are used to describe dispersion in glass using a series of resonances, here generalized to support variations found in the literature:\n\nn^2(lambda) =\n1 + A + sum_i frac B_ilambda^p_ilambda^2-C_i + sum_j D_j lambda^q_j\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#ElectricFields.BK7","page":"Dispersion","title":"ElectricFields.BK7","text":"BK7\n\nBorosilicate glass is commonly used in optical lenses\n\nn^2(lambda) =\n1 +\nfrac103961212lambda^2lambda^2 - 600069867times10^-3textrmμm^2 +\nfrac0231792344lambda^2lambda^2 - 200179144times10^-2textrmμm^2 +\nfrac101046945lambda^2 - 103560653times10^2textrmμm^2\n\n\n\n\n\n","category":"constant"},{"location":"dispersion/#ElectricFields.SiO₂","page":"Dispersion","title":"ElectricFields.SiO₂","text":"SiO₂\n\nFused silica\n\nn^2(lambda) =\n1 +\nfrac06961663lambda^2lambda^2-(00684043textrmμm)^2 +\nfrac04079426lambda^2lambda^2-(01162414textrmμm)^2 +\nfrac08974794lambda^2lambda^2-(9896161textrmμm)^2\n\n\n\n\n\n","category":"constant"},{"location":"dispersion/#ElectricFields.Calcite","page":"Dispersion","title":"ElectricFields.Calcite","text":"Calcite\n\nCalcite is a uniaxial, birefringent crystal.\n\nNumbers taken from http://www.newlightphotonics.com/v1/calcite-properties.html.\n\nbeginaligned\nn_mathrmo^2(lambda)\n=\n269705 +\nfrac00192064lambda^2-001820textrmμm^2 -\n00151624lambda^2 \nn_mathrme^2(lambda)\n=\n218438 +\nfrac00087309lambda^2-001018textrmμm^2 -\n00024411lambda^2\nendaligned\n\n\n\n\n\n","category":"constant"},{"location":"dispersion/#ElectricFields.Quartz","page":"Dispersion","title":"ElectricFields.Quartz","text":"Quartz\n\nQuartz is a uniaxial, birefrigent crystal.\n\nNumbers taken from https://www.newlightphotonics.com/v1/quartz-properties.html.\n\nbeginaligned\nn_mathrmo^2(lambda)\n=23573 -\n001170textrmμm^-2lambda^2 +\nfrac001054textrmμm^2lambda^2 +\nfrac13414times10^-4textrmμm^4lambda^4 -\nfrac44537times10^-7textrmμm^6lambda^6 +\nfrac59236times10^-8textrmμm^8lambda^8 \nn_mathrme^2(lambda)\n=23849 -\n001259textrmμm^-2lambda^2 +\nfrac001079textrmμm^2lambda^2 +\nfrac16518times10^-4textrmμm^4lambda^4 -\nfrac19474times10^-6textrmμm^6lambda^6 +\nfrac93648times10^-8textrmμm^8lambda^8\nendaligned\n\n\n\n\n\n","category":"constant"},{"location":"dispersion/#ElectricFields.KTP","page":"Dispersion","title":"ElectricFields.KTP","text":"KTP\n\nKTP is a biaxial crystal.\n\nNumbers taken from https://www.redoptronics.com/KTP-crystal.html.\n\nbeginaligned\nn_x^2(lambda)\n= 210468 +\nfrac089342lambda^2lambda^2-004438textrmμm^2 -\n001036textrmμm^-2lambda^2 \nn_y^2(lambda)\n= 214559 +\nfrac087629lambda^2lambda^2-00485textrmμm^2 -\n001173textrmμm^-2lambda^2 \nn_z^2(lambda)\n= 19446 +\nfrac13617lambda^2lambda^2-0047textrmμm^2 -\n001491textrmμm^-2lambda^2 \nendaligned\n\n\n\n\n\n","category":"constant"},{"location":"dispersion/#B-splines","page":"Dispersion","title":"B-splines","text":"","category":"section"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"The present B-spline implementation is cannibalized from CompactBases.jl, to avoid dragging in all the dependencies.","category":"page"},{"location":"dispersion/","page":"Dispersion","title":"Dispersion","text":"BSplineField\nElectricFields.BSpline","category":"page"},{"location":"dispersion/#ElectricFields.BSplineField","page":"Dispersion","title":"ElectricFields.BSplineField","text":"BSplineField(B, C)\n\nRepresents an electric field using an expansion over a B-spline basis B, with C being the array (vector for 1d fields, 3-column matrix for 3d fields) expansion coefficients for the vector potential.\n\n\n\n\n\n","category":"type"},{"location":"dispersion/#ElectricFields.BSpline","page":"Dispersion","title":"ElectricFields.BSpline","text":"BSpline(t, x, w, B, S)\n\nBasis structure for the B-splines generated by the knot set t.\n\n\n\n\n\n","category":"type"},{"location":"reference/#Reference","page":"Reference","title":"Reference","text":"","category":"section"},{"location":"reference/#Internals","page":"Reference","title":"Internals","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"ElectricFields.calc_params!\nElectricFields.@namespace!\nElectricFields.gaussian_common!\nElectricFields.test_field_parameters\nElectricFields.convolution\nElectricFields.DiracComb","category":"page"},{"location":"reference/#ElectricFields.calc_params!","page":"Reference","title":"ElectricFields.calc_params!","text":"calc_params!(field_params)\n\nThis function performs the calculation of different quantities from the information provided.\n\n\n\n\n\n","category":"function"},{"location":"reference/#ElectricFields.@namespace!","page":"Reference","title":"ElectricFields.@namespace!","text":"@namespace!(exprs, params)\n\nThis macro uses the dictionary params as a \"namespace\", i.e. all symbols are assumed to be keys in this dictionary. We need to escape the generated expression tree to modify in the scope of the caller, not the global scope.\n\n\n\n\n\n","category":"macro"},{"location":"reference/#ElectricFields.gaussian_common!","page":"Reference","title":"ElectricFields.gaussian_common!","text":"gaussian_common!(field_params, carrier[; Tmax_rounder, verbosity])\n\nCompute parameters common to Gaussian envelopes, i.e. GaussianEnvelope and TruncatedGaussianEnvelope; most importantly, given an intensity FWHM or σ, we need to figure out the coefficient alpha for the envelope of the vector potential exp(-alpha t^2), such that the electric field amplitude and intensity have the desired durations. The optional function Tmax_rounder determines if the envelop should be extended to encompass an integer amount of cycles of the carrier (default).\n\n\n\n\n\n","category":"function"},{"location":"reference/#ElectricFields.test_field_parameters","page":"Reference","title":"ElectricFields.test_field_parameters","text":"test_field_parameters(field_params, set)\n\nThis function ensures that one and only one of \"competing\" quantities is specified.\n\n\n\n\n\n","category":"function"},{"location":"reference/#ElectricFields.convolution","page":"Reference","title":"ElectricFields.convolution","text":"convolution(f̂::Function, dc::DiracComb, ω)\n\nEvaluate the convolution between the function f̂ (assumed to be the Fourier transform of a function f) with the DiracComb dc. This is used to implement the Fourier transform of a function product f(t)g(t), where g(t) is a sum of monochromatic waves:\n\nf(t)g(t)\nrightsquigarrow\nfrac1sqrt2pi\n(hatfstarhatg)(omega)\n\n\n\n\n\n","category":"function"},{"location":"reference/#ElectricFields.DiracComb","page":"Reference","title":"ElectricFields.DiracComb","text":"DiracComb(frequencies)\n\nRepresents a Dirac frequency comb, where frequencies is a vector of Tuples: (ωᵢ,cᵢ), representing a frequency and an amplitude:\n\nmathrmDC(omega) =\nsum_i\nc_i\ndelta(omega-omega_i)\n\n\n\n\n\n","category":"type"},{"location":"reference/#Index","page":"Reference","title":"Index","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = ElectricFields\nDocTestSetup = quote\n    using ElectricFields, Unitful, UnitfulAtomic\nend","category":"page"},{"location":"#ElectricFields.jl","page":"Home","title":"ElectricFields.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The idea of this package is to provide an interface between the reality and calculations. In the calculations, it is useful to represent fields in terms of cycles of a fundamental frequency, which yields a timebase. E.g. one might use laser pulses of 800 nm, in an experiment, which has a period time of about 2.66 fs. It is, however, easier to calculate in normalized time, and relate all other quantities of interest (such as ionization potential, &c) to this time scale.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The package provides a simple DSL that requires just a handful of parameters, that can be given in any unit system (thanks to Unitful.jl). Different fields can be combined in any way that is physically reasonable, to recreate complicated experimental situations. Everything can then be converted to normalized time, for use in calculations.","category":"page"},{"location":"#Scope","page":"Home","title":"Scope","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"At the moment, only electric fields that are the solution of the Helmholtz equation, i.e. those that are separable in the time and space coordinates, are supported. Further more, the spatial dependence is neglected entirely (long wavelength approximation), and only the temporal behaviour is modelled. This appropriate when studying systems which are smaller than the fundamental wavelength of the field, such as atoms in a laser field. It may be problematic for larger molecules, which can be sensitive to the spatial variation of the field.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The temporal structure of the field is modelled as","category":"page"},{"location":"","page":"Home","title":"Home","text":"vecA(t) = A_0 f(t) ImvecJ expim(omega t + phi)","category":"page"},{"location":"","page":"Home","title":"Home","text":"where A_0 is the peak vector potential, f(t) is the envelope (which does not have to be slowly varying in time, i.e. can be ultrashort), vecJ is the Jones vector, and expim(omega t + phi) is the carrier. At present only linear polarization, or polarization transverse to the direction of propagation is supported, i.e. no longitudinal polarization is implemented.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The electric field amplitude is computed as","category":"page"},{"location":"","page":"Home","title":"Home","text":"vecF(t) defd -partial_t vecA(t)","category":"page"},{"location":"","page":"Home","title":"Home","text":"via automatic differentiation (ForwardDiff.jl).","category":"page"},{"location":"","page":"Home","title":"Home","text":"Presently, only the temporal picture is well supported in ElectricFields.jl, since the main usage (for now) is to provide input to time-propagation of the time-dependent Schrödinger equation. The equivalent spectral picture, related to the temporal one via the Fourier transform, will receive better support in a future release.","category":"page"},{"location":"#Examples","page":"Home","title":"Examples","text":"","category":"section"},{"location":"#Linear-polarization","page":"Home","title":"Linear polarization","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The simplest pulse is created thus:","category":"page"},{"location":"","page":"Home","title":"Home","text":"julia> using ElectricFields, Unitful\n\njulia> @field(IR) do\n       I₀ = 1e14u\"W/cm^2\"\n       λ = 800.0u\"nm\"\n       τ = 6.2u\"fs\"\n       σmax = 6.0\n       end\nLinearly polarized field with\n  - I₀ = 2.8495e-03 au = 1.0e14 W cm^-2 =>\n    - E₀ = 5.3380e-02 au = 27.4492 GV m^-1\n    - A₀ = 0.9372 au\n  – a Fixed carrier @ λ = 800.0000 nm (T = 2.6685 fs, ω = 0.0570 Ha = 1.5498 eV, f = 374.7406 THz)\n  – and a Gaussian envelope of duration 6.2000 fs (intensity FWHM; ±6.08σ)\n  – and a bandwidth of 0.0108 Ha = 294.3469 meV ⟺ 71.1728 THz ⟺ 2871.2568 Bohr = 151.9404 nm\n  – Uₚ = 0.2196 Ha = 5.9759 eV => α = 16.4562 Bohr = 870.8242 pm\n\njulia> vector_potential(IR, 4.0)\n0.21160647961322293\n\njulia> field_amplitude(IR, 4.0), field_envelope(IR, 4.0)\n(-0.05194703530281699, 0.05336224984361333)\n\njulia> instantaneous_intensity(IR, 4.0), intensity(IR, 4.0)\n(0.0026984944767521144, 0.0028475297083722113)\n\njulia> span(IR)\n-661.9198939608042 .. 661.9198939608042\n\njulia> timeaxis(IR)\n-661.9198939608042:1.1041199232040104:661.9198939608042","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: Simple example)","category":"page"},{"location":"","page":"Home","title":"Home","text":"If we give no units, Hartree atomic units are assumed:","category":"page"},{"location":"","page":"Home","title":"Home","text":"julia> @field(XUV) do\n       I₀ = 0.04\n       ω = 1.0\n       τ = 150.0\n       σmax = 4\n       end\nLinearly polarized field with\n  - I₀ = 4.0000e-02 au = 1.40377808e15 W cm^-2 =>\n    - E₀ = 2.0000e-01 au = 102.8441 GV m^-1\n    - A₀ = 0.2000 au\n  – a Fixed carrier @ λ = 45.5634 nm (T = 151.9830 as, ω = 1.0000 Ha = 27.2114 eV, f = 6.5797 PHz)\n  – and a Gaussian envelope of duration 3.6283 fs (intensity FWHM; ±4.04σ)\n  – and a bandwidth of 0.0185 Ha = 502.9732 meV ⟺ 121.6184 THz ⟺ 15.9151 Bohr = 842.1896 pm\n  – Uₚ = 0.0100 Ha = 272.1138 meV => α = 0.2000 Bohr = 10.5835 pm","category":"page"},{"location":"#Arbitrary-polarization,-composite-fields","page":"Home","title":"Arbitrary polarization, composite fields","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Other Envelopes and polarizations, as well as some simple arithmetic is possible:","category":"page"},{"location":"","page":"Home","title":"Home","text":"julia> @field(A) do\n           I₀ = 1.0\n           ω = 1.0\n           cycles = 6.0\n           env = :cos²\n           ξ = 1.0\n       end\nTransversely polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 1.0000 au\n  – a Elliptical carrier with ξ = 1.00 (RCP) @ λ = 45.5634 nm (T = 151.9830 as, ω = 1.0000 Ha = 27.2114 eV, f = 6.5797 PHz)\n  – and a 6.00 cycles cos² envelope\n  – and a bandwidth of Inf Ha = Inf eV ⟺ Inf Hz ⟺ Inf Bohr = Inf m\n  – Uₚ = 0.2500 Ha = 6.8028 eV => α = 1.0000 Bohr = 52.9177 pm\n\njulia> @field(B) do\n           I₀ = 1.0\n           ω = 2.0\n           cycles = 6.0\n           env = :cos²\n           ξ = -1.0\n       end\nTransversely polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.5000 au\n  – a Elliptical carrier with ξ = -1.00 (LCP) @ λ = 22.7817 nm (T = 75.9915 as, ω = 2.0000 Ha = 54.4228 eV, f = 13.1594 PHz)\n  – and a 6.00 cycles cos² envelope\n  – and a bandwidth of Inf Ha = Inf eV ⟺ Inf Hz ⟺ Inf Bohr = Inf m\n  – Uₚ = 0.0625 Ha = 1.7007 eV => α = 0.2500 Bohr = 13.2294 pm\n\njulia> F = A + delay(B, 3/2π)\n┌ Transversely polarized field with\n│   - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n│     - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n│     - A₀ = 1.0000 au\n│   – a Elliptical carrier with ξ = 1.00 (RCP) @ λ = 45.5634 nm (T = 151.9830 as, ω = 1.0000 Ha = 27.2114 eV, f = 6.5797 PHz)\n│   – and a 6.00 cycles cos² envelope\n│   – and a bandwidth of Inf Ha = Inf eV ⟺ Inf Hz ⟺ Inf Bohr = Inf m\n│   – Uₚ = 0.2500 Ha = 6.8028 eV => α = 1.0000 Bohr = 52.9177 pm\n⊕\n│ Transversely polarized field with\n│   - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n│     - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n│     - A₀ = 0.5000 au\n│   – a Elliptical carrier with ξ = -1.00 (LCP) @ λ = 22.7817 nm (T = 75.9915 as, ω = 2.0000 Ha = 54.4228 eV, f = 13.1594 PHz)\n│   – and a 6.00 cycles cos² envelope\n│   – and a bandwidth of Inf Ha = Inf eV ⟺ Inf Hz ⟺ Inf Bohr = Inf m\n│   – Uₚ = 0.0625 Ha = 1.7007 eV => α = 0.2500 Bohr = 13.2294 pm\n└   – delayed by 0.4775 jiffies = 11.5493 as\n\n\njulia> field_amplitude(F, 4.0)\n3-element StaticArraysCore.SVector{3, Float64} with indices SOneTo(3):\n -0.8793235934912674\n -0.0\n  0.06802883592577502","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: Simple polarized example)","category":"page"},{"location":"#Spectra","page":"Home","title":"Spectra","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"We can compute the spectrum of a field using either the Fast Fourier Transform fft, nfft, or for some fields analytically field_amplitude_spectrum:","category":"page"},{"location":"","page":"Home","title":"Home","text":"julia> @field(F) do\n           I₀ = 1.0\n           T = 1.0\n           τ = 2.0\n           σmax = 6.0\n       end\nLinearly polarized field with\n  - I₀ = 1.0000e+00 au = 3.5094452e16 W cm^-2 =>\n    - E₀ = 1.0000e+00 au = 514.2207 GV m^-1\n    - A₀ = 0.1592 au\n  – a Fixed carrier @ λ = 7.2516 nm (T = 24.1888 as, ω = 6.2832 Ha = 170.9742 eV, f = 41.3414 PHz)\n  – and a Gaussian envelope of duration 48.3777 as (intensity FWHM; ±7.06σ)\n  – and a bandwidth of 1.3863 Ha = 37.7230 eV ⟺ 9.1214 PHz ⟺ 30.2350 Bohr = 1.6000 nm\n  – Uₚ = 0.0063 Ha = 172.3181 meV => α = 0.0253 Bohr = 1.3404 pm\n\njulia> t = timeaxis(F)\n-6.0:0.010008340283569641:6.0\n\njulia> Fv = field_amplitude(F, t);\n\njulia> Av = vector_potential(F, t);\n\njulia> ω = fftshift(fftω(t));\n\njulia> # We need to undo the phase, since the FFT does not care that\n       # pulse is centred around zero.\n       F̂v = exp.(im*ω*t[1]) .* fftshift(nfft(F, t), 1);\n\njulia> Âv = exp.(im*ω*t[1]) .* fftshift(nfft_vector_potential(F, t), 1);\n\njulia> F̂v_exact = field_amplitude_spectrum(F, ω);\n\njulia> Âv_exact = vector_potential_spectrum(F, ω);","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: Simple spectrum example)","category":"page"},{"location":"#Reference","page":"Home","title":"Reference","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"DocTestSetup = nothing","category":"page"}]
}
